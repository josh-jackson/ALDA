<!DOCTYPE html>
<html lang="en-us">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.4.0">

  

  
  
  
  
  
  

  

  
  
  
    
  
  <meta name="description" content="two timepoint models">

  
  <link rel="alternate" hreflang="en-us" href="/lectures/week-11/">

  


  

  
  
  
  <meta name="theme-color" content="rgb(0, 136, 204)">
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.0/css/all.css" integrity="sha384-aOkxzJ5uQz7WBObEZcHvV5JvRW3TUc2rNPA7pe3AwnsUohiw1Vj2Rgx2KSOkF5+h" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" integrity="sha256-ygkqlh3CYSUri3LhQxzdcm0n1EQvH2Y+U5S2idbLtxs=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/github.min.css" crossorigin="anonymous" title="hl-light" disabled>
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark">
        
      
    

    

    

  

  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700|Roboto:400,400italic,700|Roboto+Mono&display=swap">
  

  
  
  
  <link rel="stylesheet" href="/css/academic.min.301ab7eca2ca7d1311ed71a9afa2cc4f.css">

  

  
  
  

  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon-32.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="/lectures/week-11/">

  
  
  
  
    
    
  
  
  <meta property="twitter:card" content="summary">
  
  <meta property="twitter:site" content="@jackson_josh_">
  <meta property="twitter:creator" content="@jackson_josh_">
  
  <meta property="og:site_name" content="Applied Longitudinal Data Analysis">
  <meta property="og:url" content="/lectures/week-11/">
  <meta property="og:title" content="Week 11-13 | Applied Longitudinal Data Analysis">
  <meta property="og:description" content="two timepoint models"><meta property="og:image" content="/img/icon-192.png">
  <meta property="twitter:image" content="/img/icon-192.png"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2019-11-07T00:00:00&#43;00:00">
    
    <meta property="article:modified_time" content="2019-11-07T10:52:04-06:00">
  

  


  





  <title>Week 11-13 | Applied Longitudinal Data Analysis</title>

</head>

<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class="dark">

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  
<nav class="navbar navbar-light fixed-top navbar-expand-lg py-0 compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
      <a class="navbar-brand" href="/">Applied Longitudinal Data Analysis</a>
      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
        <span><i class="fas fa-bars"></i></span>
      </button>
      

    
    <div class="collapse navbar-collapse" id="navbar">

      
      
      <ul class="navbar-nav mr-auto">
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link  active" href="/lectures"><span>Lectures</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/workshops"><span>Workshops</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/homeworks"><span>Homeworks</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/syllabus"><span>Syllabus</span></a>
        </li>

        
        

      
      </ul>
      <ul class="navbar-nav ml-auto">
      

        

        
        <li class="nav-item">
          <a class="nav-link js-search" href="#"><i class="fas fa-search" aria-hidden="true"></i></a>
        </li>
        

        

        
        <li class="nav-item">
          <a class="nav-link js-dark-toggle" href="#"><i class="fas fa-moon" aria-hidden="true"></i></a>
        </li>
        

      </ul>

    </div>
  </div>
</nav>


  <article class="article" itemscope itemtype="http://schema.org/Article">

  












  

  
  
  
<div class="article-container pt-3">
  <h1 itemprop="name">Week 11-13</h1>

  

  
    



<meta content="2019-11-07 00:00:00 &#43;0000 UTC" itemprop="datePublished">
<meta content="2019-11-07 10:52:04 -0600 CST" itemprop="dateModified">

<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
          Last updated on
      
    
    <time>Nov 7, 2019</time>
  </span>
  

  

  

  
  
  

  
  

  
    

  

</div>

    














  
</div>



  <div class="article-container">

    <div class="article-style" itemprop="articleBody">
      

<div id="TOC">
<ul>
<li><a href="#suggested-readings">Suggested readings</a></li>
<li><a href="#two-wave-assessments">Two wave assessments</a><ul>
<li><a href="#lords-paradox">Lords Paradox</a></li>
</ul></li>
<li><a href="#common-two-wave-models-in-path-analysis-form">common two wave models in path analysis form</a><ul>
<li><a href="#residualized-change-model">Residualized change model</a></li>
<li><a href="#latent-change-score">Latent change score</a></li>
<li><a href="#residualized-latent-change-score">Residualized latent change score</a></li>
<li><a href="#conditional-models">Conditional Models</a></li>
<li><a href="#multiple-group-models">Multiple group models</a></li>
<li><a href="#bi-variate-latent-change-model">Bi-variate latent change model</a></li>
</ul></li>
<li><a href="#latent-differencechange-score-model">Latent difference/change score model</a></li>
<li><a href="#multiple-wave-latent-difference-score-model-lds">Multiple wave Latent Difference Score model (LDS)</a><ul>
<li><a href="#predicting-change">predicting change</a></li>
<li><a href="#adding-intercept-and-growth-factors-to-lds-models">adding intercept and growth factors to LDS models</a></li>
<li><a href="#steyer-models">“steyer” models</a></li>
<li><a href="#adding-time-varying-covariates">adding time varying covariates</a></li>
</ul></li>
<li><a href="#latent-duel-change-score-model-like-a-residualized-latent-change-score">Latent Duel change score model (like a residualized latent change score)</a></li>
<li><a href="#bivariate-multi-wave-latent-change-model">Bivariate multi wave latent change model</a><ul>
<li><a href="#alt-and-alt-sr">ALT and ALT-SR</a></li>
</ul></li>
</ul>
</div>

<div id="suggested-readings" class="section level1">
<h1>Suggested readings</h1>
<p><a href="https://www.annualreviews.org/doi/abs/10.1146/annurev.psych.60.110707.163612" class="uri">https://www.annualreviews.org/doi/abs/10.1146/annurev.psych.60.110707.163612</a></p>
<p><a href="https://www.sciencedirect.com/science/article/pii/S187892931730021X#sec0125" class="uri">https://www.sciencedirect.com/science/article/pii/S187892931730021X#sec0125</a></p>
</div>
<div id="two-wave-assessments" class="section level1">
<h1>Two wave assessments</h1>
<p>There are a lot of pre-post designs. In fact, the recent Nobel prize winners have a famous paper looking at difference in difference designs, basically looking at two group pre-post tests. Collecting longitudinal data is hard, so it makes sense that a lot of this type of data will be laying around. How do we analyze it? The first thing to notice is that we jumped right into MLM this semester, bypassing simple discussions. As a result, we can only really look at change with 3 or more waves.</p>
<p>How to measure change, or should we? <a href="https://www.gwern.net/docs/dnb/1970-cronbach.pdf" class="uri">https://www.gwern.net/docs/dnb/1970-cronbach.pdf</a> This paper lays out some of the problems that occur with standard treatments of two wave assessments.</p>
<p>The most basic two wave form of change is a difference score. However, many have said these are problematic.
The issues are:
1. hard to separate measurement error from true change
2. unreliable estimate of change
3. initial level (or last level) may be driving change. How to account for?</p>
<p>The second alternative is a standard residual gain/change score where you regress time 2 onto time 1. This overcomes some of the issues raised about because we are being conservative about the error by “regressing to the mean” such that people with larger changes than average will have their change scores “shrunken” to the average, must like we do with MLMs. This also helps with accounting for starting values that may be responsible for the changes, as this is literally controlling for the initial level.</p>
<p>The issues with this however are:
1. it isn’t true change, as you are implying people change similarly
2. it does not account for unreliability of change in a principled way
3. error, which should be random, is considered as change (ie residual is re-characterized) and it is likely associated with T1.</p>
<div id="lords-paradox" class="section level2">
<h2>Lords Paradox</h2>
<p>This has lead to what is known as Lord’s paradox. Take the two approaches above, simplified to:</p>
<p><code>lm(t2-t1 ~ group)</code>
<code>lm(t2 ~ t1 + group)</code></p>
<pre class="r"><code>head(df)</code></pre>
<pre><code>##   id group          T1          T2        change
## 1  1    Tx -0.30176644 -0.07218389  0.2295825445
## 2  2    Tx  0.06935731  0.09741980  0.0280624915
## 3  3    Tx  0.27111029  0.12699551 -0.1441147849
## 4  4    Tx -0.58642443 -0.16449642  0.4219280069
## 5  5    Tx  0.10728117  0.07408057 -0.0332006005
## 6  6    Tx  0.12651397  0.12665183  0.0001378524</code></pre>
<p>change score/gain score model</p>
<pre class="r"><code>summary(lm(change ~ group, df)) </code></pre>
<pre><code>## 
## Call:
## lm(formula = change ~ group, data = df)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -0.5174 -0.1133  0.0208  0.1310  0.4612 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)  0.038975   0.017300   2.253   0.0254 *
## groupControl 0.004028   0.024466   0.165   0.8694  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.173 on 198 degrees of freedom
## Multiple R-squared:  0.0001369,  Adjusted R-squared:  -0.004913 
## F-statistic: 0.02711 on 1 and 198 DF,  p-value: 0.8694</code></pre>
<p>residualized change score model</p>
<pre class="r"><code>summary(lm(T2 ~ group + T1, df))</code></pre>
<pre><code>## 
## Call:
## lm(formula = T2 ~ group + T1, data = df)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.315819 -0.066341  0.005835  0.060977  0.268154 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   0.01724    0.01008    1.71   0.0888 .  
## groupControl  0.44744    0.02648   16.90   &lt;2e-16 ***
## T1            0.44538    0.02797   15.92   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.1002 on 197 degrees of freedom
## Multiple R-squared:  0.9463, Adjusted R-squared:  0.9457 
## F-statistic:  1734 on 2 and 197 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>What is going on? We are asking different questions by not accounting for T1 in the former model. The change score model is accounting for the total effect (in mediation language) whereas the residualized change score model is only interested in the direct effect.</p>
<pre class="r"><code>library(lavaan)</code></pre>
<pre><code>## This is lavaan 0.6-4</code></pre>
<pre><code>## lavaan is BETA software! Please report any bugs.</code></pre>
<pre class="r"><code>library(semPlot)</code></pre>
<pre><code>## Registered S3 methods overwritten by &#39;huge&#39;:
##   method    from   
##   plot.sim  BDgraph
##   print.sim BDgraph</code></pre>
<pre class="r"><code>mod &lt;- &#39;
  T1 ~ a*group
  T2 ~ b*group + c*T1
  
  # total effect
  TE := (a*-1) + (a*c*1) + (b*1)  
&#39;
lord &lt;- sem(mod, data=df)
summary(lord)</code></pre>
<pre><code>## lavaan 0.6-4 ended normally after 28 iterations
## 
##   Optimization method                           NLMINB
##   Number of free parameters                          5
## 
##   Number of observations                           200
## 
##   Estimator                                         ML
##   Model Fit Test Statistic                       0.000
##   Degrees of freedom                                 0
##   Minimum Function Value               0.0000000000000
## 
## Parameter Estimates:
## 
##   Information                                 Expected
##   Information saturated (h1) model          Structured
##   Standard Errors                             Standard
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   T1 ~                                                
##     group      (a)    0.800    0.036   22.317    0.000
##   T2 ~                                                
##     group      (b)    0.447    0.026   17.028    0.000
##     T1         (c)    0.445    0.028   16.043    0.000
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##    .T1                0.064    0.006   10.000    0.000
##    .T2                0.010    0.001   10.000    0.000
## 
## Defined Parameters:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##     TE                0.004    0.024    0.165    0.869</code></pre>
<pre class="r"><code>semPaths(lord)</code></pre>
<p><img src="/Lectures/2019-11-07-week-11_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>What is not immediately obvious is that the change score can be conceptualized as a series of regressions. Starting with the residualized change score model</p>
<p><code>T2 = b*T1 + e</code></p>
<p>If we assume that the relationship (b) between T1 and T2 is 1. We can re-write as:</p>
<p><code>T2 = 1*T1 + e</code></p>
<p>Then we can subtract T1 fro each side of the model, leaving:</p>
<p><code>T2 - T1 = e</code></p>
<p>In other words, a change score is equivalent to assuming a perfect regression association (correlation) between timepoints.</p>
<p>Here, the residual will be equal to the average change and the variance of that will be the variance in the change. This can be thought of as akin to the mean and variance of our latent slope variable.</p>
</div>
</div>
<div id="common-two-wave-models-in-path-analysis-form" class="section level1">
<h1>common two wave models in path analysis form</h1>
<p>Lets visualize each of these models via path models</p>
<div id="residualized-change-model" class="section level2">
<h2>Residualized change model</h2>
<p><img src="res.change.png" /></p>
<pre class="r"><code>knitr::include_graphics(&quot;/img/res.change.png&quot;)</code></pre>
<p><img src="/img/res.change.png" /><!-- --></p>
<p>Our latent residual can be conceptualized as what is left over from T2 after accounting for T1 (based on the average association between T1 and T2). We now have a measure of error/change that is not correlated to T1.</p>
<p>If we wanted to, because this is SEM, we could test this model against a no change model. What would this look like? Well we would fix <span class="math inline">\(\beta_1\)</span>⁩ to zero and compare the models</p>
<pre class="r"><code>res.change &lt;- &#39;
  T2 ~ T1
&#39;
res.change &lt;- sem(res.change, data=df)
summary(res.change)</code></pre>
<pre><code>## lavaan 0.6-4 ended normally after 13 iterations
## 
##   Optimization method                           NLMINB
##   Number of free parameters                          2
## 
##   Number of observations                           200
## 
##   Estimator                                         ML
##   Model Fit Test Statistic                       0.000
##   Degrees of freedom                                 0
##   Minimum Function Value               0.0000000000000
## 
## Parameter Estimates:
## 
##   Information                                 Expected
##   Information saturated (h1) model          Structured
##   Standard Errors                             Standard
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   T2 ~                                                
##     T1                0.845    0.023   36.317    0.000
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##    .T2                0.024    0.002   10.000    0.000</code></pre>
</div>
<div id="latent-change-score" class="section level2">
<h2>Latent change score</h2>
<p>Looping back to concerns about difference scores and residualized change scores, we can address these using SEM. The problems raised above go away when: 1) measuring change latently, and thus error free. 2.) separate initial levels from change. Both of these are accomplished above. However, what is not accomplished is getting terms similar to the slope component ie a mean and a variance of a slope.</p>
<p>Knowing what we know about recreating difference scores via constraints, we can also make a latent change score by modifying this path model.</p>
<p><img src="latent.change.png" /></p>
<p>Now we can interpret the residual as change, as it is explicitly what is left over from T2 after accoutering for T1. This is starting to look like what we have been doing recently. We have:
1. Mean and variance of the slope(change), akin to our random and fixed effects in MLM
2. Covariance between intercept and slope.</p>
<p>To test whether or not our slope is significant we can compare that with a model where slope is constrained to be zero. Same for testing the slope variance.</p>
<pre class="r"><code>library(lavaan)
latent.change &lt;- &#39;
  #define difference score
  T2 ~ 1*T1
  
  # define the latent change variable
  change =~ 1*T2
  
  #estimate means
  change ~ 1
  T1 ~ 1
  
  #Constrains mean of T2 to 0
  T2 ~0*1

  #estimate variance of change
  change ~~ change

  #estimate variance of T1 intercept
  T1 ~~ T1
  
  #constrain variance of T2 to 0
  T2 ~~ 0*T2

  #intercept slope covariance
  change ~~ T1
&#39;

latent.change &lt;- sem(latent.change, data=df)
summary(latent.change)</code></pre>
<pre><code>## lavaan 0.6-4 ended normally after 18 iterations
## 
##   Optimization method                           NLMINB
##   Number of free parameters                          5
## 
##   Number of observations                           200
## 
##   Estimator                                         ML
##   Model Fit Test Statistic                       0.000
##   Degrees of freedom                                 0
## 
## Parameter Estimates:
## 
##   Information                                 Expected
##   Information saturated (h1) model          Structured
##   Standard Errors                             Standard
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   change =~                                           
##     T2                1.000                           
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   T2 ~                                                
##     T1                1.000                           
## 
## Covariances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   change ~~                                           
##     T1               -0.035    0.006   -5.553    0.000
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##     change            0.041    0.012    3.367    0.001
##     T1                0.361    0.033   10.774    0.000
##    .T2                0.000                           
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##     change            0.030    0.003   10.000    0.000
##     T1                0.224    0.022   10.000    0.000
##    .T2                0.000</code></pre>
</div>
<div id="residualized-latent-change-score" class="section level2">
<h2>Residualized latent change score</h2>
<p>Note that we haven’t yet removed the variance from the T1. This may or may not be something you want to do. It is mostly helpful if change has occurred prior to T1 and you are looking at the impact of some variable on change. If you are doing an intervention that takes place after T1 then maybe stick to latent change model. If you are measuring a developmental process across time and want to make sure that initial levels aren’t influencing change then you may want to do this. If you are doing that but think that initial levels are related to the change process then maybe you would be over controlling, wiping away what may be important. ¯_(ツ)_/¯</p>
<p><img src="res.lat.change.png" /></p>
<pre class="r"><code>res.latent.change &lt;- &#39;
  #define difference score
  T2 ~ 1*T1
  
  # define the latent change variable
  change =~ 1*T2
  
  #estimate means
  change ~ 1
  T1 ~ 1
  
  #Constrains mean of T2 to 0
  T2 ~0*1

  #estimate variance of change
  change ~~ change

  #estimate variance of T1 intercept
  T1 ~~ T1
  
  #constrain variance of T2 to 0
  T2 ~~ 0*T2

  #this is the only difference
  #intercept slope regression
  change ~ T1
&#39;

res.lat.change &lt;- sem(res.latent.change , data=df)
summary(res.lat.change)</code></pre>
<pre><code>## lavaan 0.6-4 ended normally after 18 iterations
## 
##   Optimization method                           NLMINB
##   Number of free parameters                          5
## 
##   Number of observations                           200
## 
##   Estimator                                         ML
##   Model Fit Test Statistic                       0.000
##   Degrees of freedom                                 0
## 
## Parameter Estimates:
## 
##   Information                                 Expected
##   Information saturated (h1) model          Structured
##   Standard Errors                             Standard
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   change =~                                           
##     T2                1.000                           
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   T2 ~                                                
##     T1                1.000                           
##   change ~                                            
##     T1               -0.155    0.023   -6.678    0.000
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##    .change            0.097    0.014    7.009    0.000
##     T1                0.361    0.033   10.774    0.000
##    .T2                0.000                           
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##    .change            0.024    0.002   10.000    0.000
##     T1                0.224    0.022   10.000    0.000
##    .T2                0.000</code></pre>
</div>
<div id="conditional-models" class="section level2">
<h2>Conditional Models</h2>
<p>What if we want to predict initial status (or control for covariate) as well as see if change is predicted by some variable?</p>
<p><img src="cond.png" /></p>
<pre class="r"><code>library(lavaan)
cond &lt;- &#39;
  #define difference score
  T2 ~ 1*T1
  
  # define the latent change variable
  change =~ 1*T2
  
  #estimate means
  change ~ 1
  T1 ~ 1
  
  #Constrains mean of T2 to 0
  T2 ~0*1

  #estimate variance of change
  change ~~ change

  #estimate variance of T1 intercept
  T1 ~~ T1
  
  #constrain variance of T2 to 0
  T2 ~~ 0*T2

  #intercept slope covariance
  change ~~ T1
  
  # predictor predicting initial status and change
  T1 ~ group
  change ~ group
  
&#39;

cond &lt;- sem(cond, data=df)
summary(cond)</code></pre>
<pre><code>## lavaan 0.6-4 ended normally after 37 iterations
## 
##   Optimization method                           NLMINB
##   Number of free parameters                          7
## 
##   Number of observations                           200
## 
##   Estimator                                         ML
##   Model Fit Test Statistic                       0.000
##   Degrees of freedom                                 0
## 
## Parameter Estimates:
## 
##   Information                                 Expected
##   Information saturated (h1) model          Structured
##   Standard Errors                             Standard
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   change =~                                           
##     T2                1.000                           
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   T2 ~                                                
##     T1                1.000                           
##   T1 ~                                                
##     group             0.800    0.036   22.317    0.000
##   change ~                                            
##     group             0.004    0.024    0.165    0.869
## 
## Covariances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##  .change ~~                                           
##    .T1               -0.036    0.004   -8.942    0.000
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##    .change            0.035    0.038    0.908    0.364
##    .T1               -0.839    0.057  -14.806    0.000
##    .T2                0.000                           
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##    .change            0.030    0.003   10.000    0.000
##    .T1                0.064    0.006   10.000    0.000
##    .T2                0.000</code></pre>
<p>Does that change regressed on group look familiar?</p>
<p>This approach works the case with categorical as well as continuous predictors.</p>
</div>
<div id="multiple-group-models" class="section level2">
<h2>Multiple group models</h2>
<p>As we have seen before, simple predictors does not allow the full range of tests on how two groups may differ. Just like before, we can specify multiple group models with this data.</p>
<p><img src="multi.group.png" /></p>
<pre class="r"><code>library(lavaan)
group &lt;- &#39;
  #define difference score
  T2 ~ 1*T1
  
  # define the latent change variable
  change =~ 1*T2
  
  #estimate means
  change ~ 1
  T1 ~ 1
  
  #Constrains mean of T2 to 0
  T2 ~0*1

  #estimate variance of change
  change ~~ change

  #estimate variance of T1 intercept
  T1 ~~ T1
  
  #constrain variance of T2 to 0
  T2 ~~ 0*T2

  #intercept slope covariance
  change ~~ T1
  
&#39;

group  &lt;- sem(group, group = &quot;group&quot;, data=df)
summary(group)</code></pre>
<pre><code>## lavaan 0.6-4 ended normally after 59 iterations
## 
##   Optimization method                           NLMINB
##   Number of free parameters                         10
## 
##   Number of observations per group         
##   Tx                                               100
##   Control                                          100
## 
##   Estimator                                         ML
##   Model Fit Test Statistic                       0.000
##   Degrees of freedom                                 0
## 
## Chi-square for each group:
## 
##   Tx                                             0.000
##   Control                                        0.000
## 
## Parameter Estimates:
## 
##   Information                                 Expected
##   Information saturated (h1) model          Structured
##   Standard Errors                             Standard
## 
## 
## Group 1 [Tx]:
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   change =~                                           
##     T2                1.000                           
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   T2 ~                                                
##     T1                1.000                           
## 
## Covariances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   change ~~                                           
##     T1               -0.036    0.006   -6.390    0.000
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##     change            0.039    0.017    2.279    0.023
##     T1               -0.039    0.025   -1.569    0.117
##    .T2                0.000                           
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##     change            0.029    0.004    7.071    0.000
##     T1                0.062    0.009    7.071    0.000
##    .T2                0.000                           
## 
## 
## Group 2 [Control]:
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   change =~                                           
##     T2                1.000                           
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   T2 ~                                                
##     T1                1.000                           
## 
## Covariances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   change ~~                                           
##     T1               -0.036    0.006   -6.258    0.000
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##     change            0.043    0.017    2.482    0.013
##     T1                0.760    0.026   29.612    0.000
##    .T2                0.000                           
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##     change            0.030    0.004    7.071    0.000
##     T1                0.066    0.009    7.071    0.000
##    .T2                0.000</code></pre>
<p>Compare that with a model where we constrain the slopes to be the same</p>
<pre class="r"><code>group2 &lt;- &#39;
  #define difference score
  T2 ~ 1*T1
  
  # define the latent change variable
  change =~ 1*T2
  
  #estimate means (here is where we constrain)
  change ~ c(s,s)*1
  T1 ~ 1
  
  #Constrains mean of T2 to 0
  T2 ~0*1

  #estimate variance of change
  change ~~ change

  #estimate variance of T1 intercept
  T1 ~~ T1
  
  #constrain variance of T2 to 0
  T2 ~~ 0*T2

  #intercept slope covariance
  change ~~ T1
  
&#39;

group2  &lt;- sem(group2, group = &quot;group&quot;, data=df)
summary(group2)</code></pre>
<pre><code>## lavaan 0.6-4 ended normally after 59 iterations
## 
##   Optimization method                           NLMINB
##   Number of free parameters                         10
##   Number of equality constraints                     1
##   Row rank of the constraints matrix                 1
## 
##   Number of observations per group         
##   Tx                                               100
##   Control                                          100
## 
##   Estimator                                         ML
##   Model Fit Test Statistic                       0.027
##   Degrees of freedom                                 1
##   P-value (Chi-square)                           0.869
## 
## Chi-square for each group:
## 
##   Tx                                             0.014
##   Control                                        0.014
## 
## Parameter Estimates:
## 
##   Information                                 Expected
##   Information saturated (h1) model          Structured
##   Standard Errors                             Standard
## 
## 
## Group 1 [Tx]:
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   change =~                                           
##     T2                1.000                           
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   T2 ~                                                
##     T1                1.000                           
## 
## Covariances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   change ~~                                           
##     T1               -0.036    0.006   -6.390    0.000
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##     change     (s)    0.041    0.012    3.365    0.001
##     T1               -0.042    0.020   -2.051    0.040
##    .T2                0.000                           
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##     change            0.029    0.004    7.071    0.000
##     T1                0.062    0.009    7.071    0.000
##    .T2                0.000                           
## 
## 
## Group 2 [Control]:
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   change =~                                           
##     T2                1.000                           
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   T2 ~                                                
##     T1                1.000                           
## 
## Covariances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   change ~~                                           
##     T1               -0.036    0.006   -6.258    0.000
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##     change     (s)    0.041    0.012    3.365    0.001
##     T1                0.763    0.021   36.181    0.000
##    .T2                0.000                           
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##     change            0.030    0.004    7.071    0.000
##     T1                0.066    0.009    7.071    0.000
##    .T2                0.000</code></pre>
<pre class="r"><code>anova(group, group2)</code></pre>
<pre><code>## Chi Square Difference Test
## 
##        Df     AIC     BIC  Chisq Chisq diff Df diff Pr(&gt;Chisq)
## group   0 -318.30 -285.31 0.0000                              
## group2  1 -320.27 -290.58 0.0274   0.027381       1     0.8686</code></pre>
<p>Notice that p value from before?</p>
</div>
<div id="bi-variate-latent-change-model" class="section level2">
<h2>Bi-variate latent change model</h2>
<p>Similar to the bivariate latent grown model, this is helpful if we want to ask whether or not two variables change in tandem.</p>
<pre class="r"><code>long &lt;- read.csv(&quot;~/Box/5165 Applied Longitudinal Data Analysis/SEM_workshop/longitudinal.csv&quot;)

bv.lcm &lt;- &#39;
  #define difference score
  PosAFF12 ~ 1*PosAFF11
  
  # define the latent change variable
  change.pa =~ 1*PosAFF12
  
  #estimate means
  change.pa ~ 1
  PosAFF11 ~ 1
  
  #Constrains mean of T2 to 0
  PosAFF12 ~0*1

  #estimate variance of change
  change.pa ~~ change.pa

  #estimate variance of T1 intercept
  PosAFF11 ~~ PosAFF11
  
  #constrain variance of T2 to 0
  PosAFF12 ~~ 0*PosAFF12

  #intercept slope covariance
  change.pa ~~ PosAFF11

  ## second process
  
   #define difference score
  NegAFF12 ~ 1*NegAFF11
  
  # define the latent change variable
  change.na =~ 1*NegAFF12
  
  #estimate means
  change.na ~ 1
  NegAFF11 ~ 1
  
  #Constrains mean of T2 to 0
  NegAFF12 ~0*1

  #estimate variance of change
  change.na ~~ change.na

  #estimate variance of T1 intercept
  NegAFF11 ~~ NegAFF11
  
  #constrain variance of T2 to 0
  NegAFF12 ~~ 0*NegAFF12

  #intercept slope covariance
  change.na ~~ NegAFF11
  
  
  ## look at the covariance between change and intercept parameters
  
  change.na ~~ change.pa

  NegAFF11 ~~ PosAFF11
  
&#39;

bv.lcm &lt;- sem(bv.lcm, data=long)
summary(bv.lcm)</code></pre>
<pre><code>## lavaan 0.6-4 ended normally after 29 iterations
## 
##   Optimization method                           NLMINB
##   Number of free parameters                         12
## 
##   Number of observations                           368
## 
##   Estimator                                         ML
##   Model Fit Test Statistic                      17.880
##   Degrees of freedom                                 2
##   P-value (Chi-square)                           0.000
## 
## Parameter Estimates:
## 
##   Information                                 Expected
##   Information saturated (h1) model          Structured
##   Standard Errors                             Standard
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   change.pa =~                                        
##     PosAFF12          1.000                           
##   change.na =~                                        
##     NegAFF12          1.000                           
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   PosAFF12 ~                                          
##     PosAFF11          1.000                           
##   NegAFF12 ~                                          
##     NegAFF11          1.000                           
## 
## Covariances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   change.pa ~~                                        
##     PosAFF11         -0.338    0.033  -10.247    0.000
##   change.na ~~                                        
##     NegAFF11         -0.297    0.026  -11.565    0.000
##   change.pa ~~                                        
##     change.na        -0.070    0.015   -4.682    0.000
##   PosAFF11 ~~                                         
##     NegAFF11         -0.056    0.015   -3.848    0.000
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##     change.pa         0.041    0.040    1.033    0.302
##     PosAFF11          3.212    0.037   86.264    0.000
##    .PosAFF12          0.000                           
##     change.na        -0.110    0.032   -3.428    0.001
##     NegAFF11          1.522    0.034   45.326    0.000
##    .NegAFF12          0.000                           
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##     change.pa         0.575    0.042   13.721    0.000
##     PosAFF11          0.510    0.037   13.668    0.000
##    .PosAFF12          0.000                           
##     change.na         0.382    0.028   13.791    0.000
##     NegAFF11          0.415    0.030   13.713    0.000
##    .NegAFF12          0.000</code></pre>
<pre class="r"><code>semPaths(bv.lcm)</code></pre>
<p><img src="/Lectures/2019-11-07-week-11_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
</div>
</div>
<div id="latent-differencechange-score-model" class="section level1">
<h1>Latent difference/change score model</h1>
<p>What if we had only two time points but had latent variables? This is where the model really starts to shine as we are better able to overcome some of the negatives of difference scores – namely that they are error filled. Here we will be measuring the variables latently to reduce error and constraining the measurement so that the assumption of measurement invariance holds.</p>
<p><img src="latent.latent.png" /></p>
<pre><code>##     T1X1     T1X2     T1X3     T2X1     T2X2     T2X3 
## 4.857927 5.415410 4.218875 5.451574 6.204090 4.819225</code></pre>
<pre><code>## ── Attaching packages ───────────────────── tidyverse 1.2.1.9000 ──</code></pre>
<pre><code>## ✔ ggplot2 3.2.1          ✔ purrr   0.3.2     
## ✔ tibble  2.1.3          ✔ dplyr   0.8.3     
## ✔ tidyr   1.0.0.9000     ✔ stringr 1.4.0     
## ✔ readr   1.3.1          ✔ forcats 0.4.0</code></pre>
<pre><code>## ── Conflicts ───────────────────────────── tidyverse_conflicts() ──
## ✖ dplyr::filter() masks stats::filter()
## ✖ dplyr::lag()    masks stats::lag()</code></pre>
<pre class="r"><code>change &lt;-

#setup is similar to standard latent difference except that we will not use latent variables as our repeated measures. 
  
&#39;C_T1=~1*T1X1 + L2*T1X2  + L3*T1X3    
C_T2=~1*T2X1 + L2*T2X2 + L3*T2X3   

C_T2 ~ 1*C_T1     # Fixed regression of C_T2 on C_T1
change_C =~ 1*C_T2     # Fixed regression of dC on C_T2
C_T2 ~ 0*1        # This line constrains the intercept of C_T2 to 0
C_T2 ~~ 0*C_T2    # This fixes the variance of the C_T2 to 0 

change_C ~ 1             # This estimates the intercept of the change score 
C_T1 ~  1           # This estimates the intercept of C_T1 
change_C ~~  change_C       # This estimates the variance of the change scores 
C_T1 ~~ C_T1     # This estimates the variance of the C_T1 
change_C ~~ C_T1 # This estimates the self-feedback parameter, which for now is just the covaration with change and T1

## new compared to no latent repeated measures
T1X1~~T2X1   # This allows residual covariance on indicator X1 across T1 and T2
T1X2~~T2X2   # This allows residual covariance on indicator X2 across T1 and T2
T1X3~~T2X3   # This allows residual covariance on indicator X3 across T1 and T2

T1X1~~T1X1   # This allows residual variance on indicator X1 
T1X2~~T1X2   # This allows residual variance on indicator X2
T1X3~~T1X3   # This allows residual variance on indicator X3

T2X1~~T2X1  # This allows residual variance on indicator X1 at T2 
T2X2~~T2X2  # This allows residual variance on indicator X2 at T2 
T2X3~~T2X3  # This allows residual variance on indicator X3 at T2


#scales the items
T1X1~0*1    # This constrains the intercept of X1 to 0 at T1
T1X2~M2*1   # This estimates the intercept of X2 at T1
T1X3~M3*1   # This estimates the intercept of X3 at T1
T2X1~0*1    # This constrains the intercept of X1 to 0 at T2
T2X2~M2*1   # This estimates the intercept of X2 at T2
T2X3~M3*1   # This estimates the intercept of X3 at T2

&#39;

change.fit &lt;- sem(change, data=simdat, missing=&quot;ML&quot;)
summary(change.fit, fit.measures=TRUE, standardized=TRUE, rsquare=TRUE)</code></pre>
<pre><code>## lavaan 0.6-4 ended normally after 49 iterations
## 
##   Optimization method                           NLMINB
##   Number of free parameters                         22
##   Number of equality constraints                     4
##   Row rank of the constraints matrix                 4
## 
##   Number of observations                           500
##   Number of missing patterns                         1
## 
##   Estimator                                         ML
##   Model Fit Test Statistic                       3.171
##   Degrees of freedom                                 9
##   P-value (Chi-square)                           0.957
## 
## Model test baseline model:
## 
##   Minimum Function Test Statistic             1005.424
##   Degrees of freedom                                15
##   P-value                                        0.000
## 
## User model versus baseline model:
## 
##   Comparative Fit Index (CFI)                    1.000
##   Tucker-Lewis Index (TLI)                       1.010
## 
## Loglikelihood and Information Criteria:
## 
##   Loglikelihood user model (H0)              -4825.052
##   Loglikelihood unrestricted model (H1)      -4823.467
## 
##   Number of free parameters                         18
##   Akaike (AIC)                                9686.104
##   Bayesian (BIC)                              9761.967
##   Sample-size adjusted Bayesian (BIC)         9704.834
## 
## Root Mean Square Error of Approximation:
## 
##   RMSEA                                          0.000
##   90 Percent Confidence Interval          0.000  0.000
##   P-value RMSEA &lt;= 0.05                          0.999
## 
## Standardized Root Mean Square Residual:
## 
##   SRMR                                           0.012
## 
## Parameter Estimates:
## 
##   Information                                 Observed
##   Observed information based on                Hessian
##   Standard Errors                             Standard
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   C_T1 =~                                                               
##     T1X1              1.000                               0.943    0.675
##     T1X2      (L2)    1.129    0.055   20.690    0.000    1.065    0.714
##     T1X3      (L3)    0.958    0.048   20.003    0.000    0.903    0.690
##   C_T2 =~                                                               
##     T2X1              1.000                               1.047    0.721
##     T2X2      (L2)    1.129    0.055   20.690    0.000    1.182    0.789
##     T2X3      (L3)    0.958    0.048   20.003    0.000    1.003    0.702
##   change_C =~                                                           
##     C_T2              1.000                               0.513    0.513
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   C_T2 ~                                                                
##     C_T1              1.000                               0.901    0.901
## 
## Covariances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   C_T1 ~~                                                               
##     change_C         -0.041    0.055   -0.747    0.455   -0.081   -0.081
##  .T1X1 ~~                                                               
##    .T2X1             -0.010    0.059   -0.174    0.862   -0.010   -0.010
##  .T1X2 ~~                                                               
##    .T2X2             -0.161    0.063   -2.571    0.010   -0.161   -0.168
##  .T1X3 ~~                                                               
##    .T2X3             -0.102    0.055   -1.868    0.062   -0.102   -0.106
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .C_T2              0.000                               0.000    0.000
##     change_C          0.644    0.048   13.548    0.000    1.199    1.199
##     C_T1              4.832    0.057   84.764    0.000    5.125    5.125
##    .T1X1              0.000                               0.000    0.000
##    .T1X2      (M2)   -0.007    0.286   -0.026    0.980   -0.007   -0.005
##    .T1X3      (M3)   -0.417    0.250   -1.669    0.095   -0.417   -0.319
##    .T2X1              0.000                               0.000    0.000
##    .T2X2      (M2)   -0.007    0.286   -0.026    0.980   -0.007   -0.005
##    .T2X3      (M3)   -0.417    0.250   -1.669    0.095   -0.417   -0.292
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .C_T2              0.000                               0.000    0.000
##     change_C          0.288    0.070    4.092    0.000    1.000    1.000
##     C_T1              0.889    0.095    9.322    0.000    1.000    1.000
##    .T1X1              1.065    0.084   12.748    0.000    1.065    0.545
##    .T1X2              1.091    0.093   11.669    0.000    1.091    0.490
##    .T1X3              0.896    0.072   12.411    0.000    0.896    0.523
##    .T2X1              1.014    0.082   12.329    0.000    1.014    0.481
##    .T2X2              0.846    0.084   10.135    0.000    0.846    0.377
##    .T2X3              1.037    0.082   12.684    0.000    1.037    0.508
## 
## R-Square:
##                    Estimate
##     C_T2              1.000
##     T1X1              0.455
##     T1X2              0.510
##     T1X3              0.477
##     T2X1              0.519
##     T2X2              0.623
##     T2X3              0.492</code></pre>
<pre class="r"><code>semPaths(change.fit )</code></pre>
<p><img src="/Lectures/2019-11-07-week-11_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p>Same as before, we can run multiple groups analyses, introduce covariates/predictors, regress change onto time 1 and look at bi-variate processes simultanously.</p>
</div>
<div id="multiple-wave-latent-difference-score-model-lds" class="section level1">
<h1>Multiple wave Latent Difference Score model (LDS)</h1>
<p>What is especially nice is that we can extend the model into more than 2 waves. This is a rethinking of how to assess 3+ waves of data. As opposed to thinking of a standard growth process that is unchanging, this instead reconceptualizing the change as a set of difference scores. You can increase, then decrease, then increase, for example. There is flexibility in this approach. First, you can get more precise assessments of when change is occuring. If you are measuring grades 5-12 with some event predictor maybe the change only occured during grades 6-7. How would you test that in a standard growth model? Second, you can model more non-linear associations with parameters that are easier to interpret than quadratics and higher order terms.</p>
<p>However there is also downsides. First, there are more parameters to estimate. More parameters mean a more difficult time in estimating the model. So it is possible that you have not as accurate (mean est) and not as precise (larger SEs) compared to a more simplistic model like a growth model. Second, there are increased analytic choices which could lead to confusing, p-hacking and all around disillusion on what is the correct model. For example, do you model all change paramters to have similar covariances across time? Do you constrain variance to be the same and allow the means to differ – or vice versa? Do you impose MI?</p>
<pre class="r"><code>y_t_all &lt;- read.csv(&quot;~/Box/5165 Applied Longitudinal Data Analysis/ALDA/combined_models.csv&quot;)</code></pre>
<pre class="r"><code>mw.model &lt;-
&#39;e7 =~ 1*TPER7_01 + cat6*TPER7_04 + cat2*TPER7_15 + cat3*TPER7_19R + cat4*TPER7_22R
e8 =~ 1*TPER8_01 + cat6*TPER8_04 + cat2*TPER8_15 + cat3*TPER8_19R + cat4*TPER8_22R
e9 =~ 1*TPER9_01 + cat6*TPER9_04 + cat2*TPER9_15 + cat3*TPER9_19R + cat4*TPER9_22R
e10 =~ 1*TPER10_01 + cat6*TPER10_04 + cat2*TPER10_15 + cat3*TPER10_19R + cat4*TPER10_22R


# settting the fixed regressions to 1

e8 ~ 1*e7     
e9 ~ 1*e8  
e10 ~ 1*e9  

# creating the change scores 

c_7.8 =~ 1*e8     
c_8.9 =~ 1*e9 
c_9.10 =~ 1*e10 


# constraint intercepts
e8 ~ 0*1        
e9 ~ 0*1   
e10 ~ 0*1   

# This fixes the variance to 0

e8 ~~ 0*e8     
e9 ~~ 0*e9  
e10 ~~ 0*e10  

# Estimate the intercept of the change score
c_7.8 ~ 1    
c_8.9 ~ 1 
c_9.10 ~ 1             

# This estimates the intercept and variance of initial time
e7 ~  1           
e7 ~~  e7 

#  Estimates the variance of the change scores
c_7.8 ~~ c_7.8    
c_8.9 ~~ c_8.9 
c_9.10 ~~ c_9.10       


# Estimates the covaration with change scores and T1
e7  ~~ c_7.8 + c_8.9 + c_9.10 
c_7.8 ~~ c_8.9 + c_9.10
c_8.9 ~~ c_9.10

## Allow indicators to covary
TPER7_01 ~~ TPER8_01 + TPER9_01 + TPER10_01
TPER8_01 ~~ TPER9_01 + TPER10_01
TPER9_01 ~~ TPER10_01

TPER7_04 ~~ TPER8_04 + TPER9_04 + TPER10_04
TPER8_04 ~~ TPER9_04 + TPER10_04
TPER9_04 ~~ TPER10_04

TPER7_15 ~~ TPER8_15 + TPER9_15 + TPER10_15
TPER8_15 ~~ TPER9_15 + TPER10_15
TPER9_15 ~~ TPER10_15

TPER7_19R ~~ TPER8_19R + TPER9_19R + TPER10_19R
TPER8_19R ~~ TPER9_19R + TPER10_19R
TPER9_19R ~~ TPER10_19R

TPER7_22R ~~ TPER8_22R + TPER9_22R + TPER10_22R
TPER8_22R ~~ TPER9_22R + TPER10_22R
TPER9_22R ~~ TPER10_22R



#scales the items and add measurement invariance

TPER7_01 ~ 0*1
TPER7_04 ~ (nu1)*1
TPER7_15 ~ (nu2)*1
TPER7_19R ~ (nu3)*1
TPER7_22R ~ (nu4)*1

TPER8_01~ 0*1
TPER8_04 ~ (nu1)*1
TPER8_15~ (nu2)*1
TPER8_19R ~ (nu3)*1
TPER8_22R~ (nu4)*1

TPER9_01~ 0*1
TPER9_04 ~ (nu1)*1
TPER9_15~ (nu2)*1
TPER9_19R ~ (nu3)*1
TPER9_22R~ (nu4)*1

TPER10_01 ~ 0*1
TPER10_04 ~ (nu1)*1
TPER10_15 ~ (nu2)*1
TPER10_19R ~ (nu3)*1
TPER10_22R ~ (nu4)*1

&#39;

mw.model &lt;- sem(mw.model, data=y_t_all , missing=&quot;ML&quot;)</code></pre>
<pre><code>## Warning in lav_data_full(data = data, group = group, cluster = cluster, : lavaan WARNING: some cases are empty and will be ignored:
##   14 24 32 33 34 36 37 39 48 49 51 57 76 78 80 83 84 86 90 91 98 109 119 129 130 131 140 144 145 157 165 167 170 171 177 180 182 183 190 206 222 227 229 234 247 250 260 287 292 295 301 302 307 327 339 342 345 349 354 356 359 360 369 370 377 383 384 386 393 406 411 414 419 421 422 425 426 429 440 442 446 448 449 450 456 460 462 470 473 476 485 491 494 496 503 504 507 508 516 532 535 539 546 547 548 552 554 555 556 559 561 563 566 571 584 586 587 591 596 599 601 607 620 630 634 635 642 645 650 651 658 666 673 678 687 716 718 732 735 737 738 740 745 751 761 766 776 785 786 788 790 795 796 802 804 823 827 831 842 847 851 853 860 887 892 901 920 923 926 927 936 938 940 947 949 952 953 955 956 957 969 972 977 979 981 985 993 999 1000 1003 1016 1029 1032 1035 1038 1040 1044 1046 1048 1050 1055 1059 1066</code></pre>
<pre><code>## Warning in lav_data_full(data = data, group = group, cluster = cluster, :
## lavaan WARNING: due to missing values, some pairwise combinations have less
## than 10% coverage</code></pre>
<pre class="r"><code>summary(mw.model, fit.measures=TRUE, standardized=TRUE)</code></pre>
<pre><code>## lavaan 0.6-4 ended normally after 73 iterations
## 
##   Optimization method                           NLMINB
##   Number of free parameters                         96
##   Number of equality constraints                    24
##   Row rank of the constraints matrix                24
## 
##                                                   Used       Total
##   Number of observations                           864        1067
##   Number of missing patterns                        29
## 
##   Estimator                                         ML
##   Model Fit Test Statistic                     833.294
##   Degrees of freedom                               158
##   P-value (Chi-square)                           0.000
## 
## Model test baseline model:
## 
##   Minimum Function Test Statistic             6120.154
##   Degrees of freedom                               190
##   P-value                                        0.000
## 
## User model versus baseline model:
## 
##   Comparative Fit Index (CFI)                    0.886
##   Tucker-Lewis Index (TLI)                       0.863
## 
## Loglikelihood and Information Criteria:
## 
##   Loglikelihood user model (H0)             -11678.547
##   Loglikelihood unrestricted model (H1)     -11261.900
## 
##   Number of free parameters                         72
##   Akaike (AIC)                               23501.094
##   Bayesian (BIC)                             23843.927
##   Sample-size adjusted Bayesian (BIC)        23615.274
## 
## Root Mean Square Error of Approximation:
## 
##   RMSEA                                          0.070
##   90 Percent Confidence Interval          0.066  0.075
##   P-value RMSEA &lt;= 0.05                          0.000
## 
## Standardized Root Mean Square Residual:
## 
##   SRMR                                           0.064
## 
## Parameter Estimates:
## 
##   Information                                 Observed
##   Observed information based on                Hessian
##   Standard Errors                             Standard
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   e7 =~                                                                 
##     TPER7_0           1.000                               1.007    0.872
##     TPER7_0 (cat6)    0.789    0.024   32.827    0.000    0.794    0.726
##     TPER7_1 (cat2)    0.987    0.022   44.223    0.000    0.994    0.854
##     TPER7_1 (cat3)    1.020    0.029   35.076    0.000    1.027    0.768
##     TPER7_2 (cat4)    1.022    0.030   34.287    0.000    1.030    0.755
##   e8 =~                                                                 
##     TPER8_0           1.000                               1.009    0.871
##     TPER8_0 (cat6)    0.789    0.024   32.827    0.000    0.796    0.703
##     TPER8_1 (cat2)    0.987    0.022   44.223    0.000    0.996    0.855
##     TPER8_1 (cat3)    1.020    0.029   35.076    0.000    1.029    0.758
##     TPER8_2 (cat4)    1.022    0.030   34.287    0.000    1.032    0.746
##   e9 =~                                                                 
##     TPER9_0           1.000                               1.032    0.856
##     TPER9_0 (cat6)    0.789    0.024   32.827    0.000    0.814    0.694
##     TPER9_1 (cat2)    0.987    0.022   44.223    0.000    1.018    0.855
##     TPER9_1 (cat3)    1.020    0.029   35.076    0.000    1.052    0.781
##     TPER9_2 (cat4)    1.022    0.030   34.287    0.000    1.055    0.779
##   e10 =~                                                                
##     TPER10_           1.000                               0.971    0.855
##     TPER10_ (cat6)    0.789    0.024   32.827    0.000    0.766    0.699
##     TPER10_ (cat2)    0.987    0.022   44.223    0.000    0.958    0.815
##     TPER10_ (cat3)    1.020    0.029   35.076    0.000    0.990    0.784
##     TPER10_ (cat4)    1.022    0.030   34.287    0.000    0.993    0.778
##   c_7.8 =~                                                              
##     e8                1.000                               1.024    1.024
##   c_8.9 =~                                                              
##     e9                1.000                               0.949    0.949
##   c_9.10 =~                                                             
##     e10               1.000                               1.017    1.017
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   e8 ~                                                                  
##     e7                1.000                               0.998    0.998
##   e9 ~                                                                  
##     e8                1.000                               0.978    0.978
##   e10 ~                                                                 
##     e9                1.000                               1.063    1.063
## 
## Covariances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   e7 ~~                                                                 
##     c_7.8            -0.532    0.073   -7.291    0.000   -0.511   -0.511
##     c_8.9             0.115    0.073    1.568    0.117    0.117    0.117
##     c_9.10           -0.085    0.117   -0.722    0.470   -0.085   -0.085
##   c_7.8 ~~                                                              
##     c_8.9            -0.571    0.086   -6.606    0.000   -0.565   -0.565
##     c_9.10            0.018    0.134    0.131    0.896    0.017    0.017
##   c_8.9 ~~                                                              
##     c_9.10           -0.482    0.089   -5.437    0.000   -0.498   -0.498
##  .TPER7_01 ~~                                                           
##    .TPER8_01          0.049    0.030    1.634    0.102    0.049    0.151
##    .TPER9_01          0.087    0.035    2.457    0.014    0.087    0.246
##    .TPER10_01        -0.205    0.052   -3.936    0.000   -0.205   -0.612
##  .TPER8_01 ~~                                                           
##    .TPER9_01          0.079    0.028    2.814    0.005    0.079    0.222
##    .TPER10_01         0.061    0.035    1.749    0.080    0.061    0.183
##  .TPER9_01 ~~                                                           
##    .TPER10_01         0.021    0.034    0.616    0.538    0.021    0.056
##  .TPER7_04 ~~                                                           
##    .TPER8_04          0.163    0.039    4.133    0.000    0.163    0.269
##    .TPER9_04          0.141    0.051    2.769    0.006    0.141    0.222
##    .TPER10_04         0.078    0.094    0.829    0.407    0.078    0.132
##  .TPER8_04 ~~                                                           
##    .TPER9_04          0.225    0.043    5.289    0.000    0.225    0.330
##    .TPER10_04         0.086    0.053    1.604    0.109    0.086    0.136
##  .TPER9_04 ~~                                                           
##    .TPER10_04         0.201    0.047    4.234    0.000    0.201    0.304
##  .TPER7_15 ~~                                                           
##    .TPER8_15          0.022    0.030    0.725    0.468    0.022    0.059
##    .TPER9_15          0.008    0.034    0.241    0.810    0.008    0.022
##    .TPER10_15        -0.137    0.070   -1.958    0.050   -0.137   -0.332
##  .TPER8_15 ~~                                                           
##    .TPER9_15          0.027    0.028    0.948    0.343    0.027    0.071
##    .TPER10_15         0.013    0.042    0.322    0.747    0.013    0.033
##  .TPER9_15 ~~                                                           
##    .TPER10_15         0.008    0.033    0.240    0.810    0.008    0.019
##  .TPER7_19R ~~                                                          
##    .TPER8_19R         0.104    0.055    1.890    0.059    0.104    0.137
##    .TPER9_19R        -0.074    0.060   -1.233    0.218   -0.074   -0.103
##    .TPER10_19R        0.189    0.092    2.059    0.040    0.189    0.282
##  .TPER8_19R ~~                                                          
##    .TPER9_19R         0.110    0.053    2.078    0.038    0.110    0.148
##    .TPER10_19R        0.053    0.069    0.775    0.438    0.053    0.077
##  .TPER9_19R ~~                                                          
##    .TPER10_19R       -0.036    0.052   -0.690    0.490   -0.036   -0.054
##  .TPER7_22R ~~                                                          
##    .TPER8_22R         0.143    0.060    2.406    0.016    0.143    0.174
##    .TPER9_22R         0.019    0.061    0.304    0.761    0.019    0.024
##    .TPER10_22R        0.160    0.108    1.487    0.137    0.160    0.223
##  .TPER8_22R ~~                                                          
##    .TPER9_22R         0.049    0.052    0.941    0.347    0.049    0.063
##    .TPER10_22R       -0.014    0.062   -0.227    0.820   -0.014   -0.019
##  .TPER9_22R ~~                                                          
##    .TPER10_22R        0.025    0.054    0.467    0.640    0.025    0.037
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .e8                0.000                               0.000    0.000
##    .e9                0.000                               0.000    0.000
##    .e10               0.000                               0.000    0.000
##     c_7.8            -0.015    0.056   -0.259    0.795   -0.014   -0.014
##     c_8.9            -0.012    0.052   -0.225    0.822   -0.012   -0.012
##     c_9.10            0.119    0.058    2.054    0.040    0.121    0.121
##     e7                3.681    0.051   72.878    0.000    3.655    3.655
##    .TPER7_01          0.000                               0.000    0.000
##    .TPER7_04 (nu1)    0.579    0.092    6.266    0.000    0.579    0.529
##    .TPER7_15 (nu2)   -0.059    0.086   -0.689    0.491   -0.059   -0.051
##    .TPER7_19 (nu3)   -0.461    0.111   -4.161    0.000   -0.461   -0.345
##    .TPER7_22 (nu4)   -0.581    0.114   -5.109    0.000   -0.581   -0.426
##    .TPER8_01          0.000                               0.000    0.000
##    .TPER8_04 (nu1)    0.579    0.092    6.266    0.000    0.579    0.511
##    .TPER8_15 (nu2)   -0.059    0.086   -0.689    0.491   -0.059   -0.051
##    .TPER8_19 (nu3)   -0.461    0.111   -4.161    0.000   -0.461   -0.340
##    .TPER8_22 (nu4)   -0.581    0.114   -5.109    0.000   -0.581   -0.420
##    .TPER9_01          0.000                               0.000    0.000
##    .TPER9_04 (nu1)    0.579    0.092    6.266    0.000    0.579    0.494
##    .TPER9_15 (nu2)   -0.059    0.086   -0.689    0.491   -0.059   -0.049
##    .TPER9_19 (nu3)   -0.461    0.111   -4.161    0.000   -0.461   -0.343
##    .TPER9_22 (nu4)   -0.581    0.114   -5.109    0.000   -0.581   -0.428
##    .TPER10_0          0.000                               0.000    0.000
##    .TPER10_0 (nu1)    0.579    0.092    6.266    0.000    0.579    0.528
##    .TPER10_1 (nu2)   -0.059    0.086   -0.689    0.491   -0.059   -0.050
##    .TPER10_1 (nu3)   -0.461    0.111   -4.161    0.000   -0.461   -0.366
##    .TPER10_2 (nu4)   -0.581    0.114   -5.109    0.000   -0.581   -0.455
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .e8                0.000                               0.000    0.000
##    .e9                0.000                               0.000    0.000
##    .e10               0.000                               0.000    0.000
##     e7                1.014    0.083   12.153    0.000    1.000    1.000
##     c_7.8             1.067    0.108    9.831    0.000    1.000    1.000
##     c_8.9             0.960    0.099    9.655    0.000    1.000    1.000
##     c_9.10            0.975    0.104    9.412    0.000    1.000    1.000
##    .TPER7_01          0.321    0.035    9.069    0.000    0.321    0.240
##    .TPER7_04          0.566    0.046   12.253    0.000    0.566    0.473
##    .TPER7_15          0.368    0.035   10.408    0.000    0.368    0.271
##    .TPER7_19R         0.733    0.063   11.624    0.000    0.733    0.410
##    .TPER7_22R         0.800    0.067   11.858    0.000    0.800    0.430
##    .TPER8_01          0.325    0.031   10.530    0.000    0.325    0.242
##    .TPER8_04          0.650    0.046   14.201    0.000    0.650    0.506
##    .TPER8_15          0.366    0.031   11.624    0.000    0.366    0.270
##    .TPER8_19R         0.786    0.059   13.328    0.000    0.786    0.426
##    .TPER8_22R         0.850    0.063   13.482    0.000    0.850    0.444
##    .TPER9_01          0.388    0.034   11.345    0.000    0.388    0.267
##    .TPER9_04          0.713    0.049   14.525    0.000    0.713    0.518
##    .TPER9_15          0.380    0.033   11.634    0.000    0.380    0.268
##    .TPER9_19R         0.706    0.055   12.837    0.000    0.706    0.389
##    .TPER9_22R         0.724    0.056   12.918    0.000    0.724    0.394
##    .TPER10_01         0.348    0.039    8.953    0.000    0.348    0.270
##    .TPER10_04         0.615    0.053   11.579    0.000    0.615    0.512
##    .TPER10_15         0.465    0.045   10.239    0.000    0.465    0.336
##    .TPER10_19R        0.613    0.059   10.412    0.000    0.613    0.385
##    .TPER10_22R        0.642    0.062   10.427    0.000    0.642    0.394</code></pre>
<pre class="r"><code>semPaths(mw.model)</code></pre>
<p><img src="/Lectures/2019-11-07-week-11_files/figure-html/unnamed-chunk-21-1.png" width="672" />
Gross. We have to draw this by hand to get a good representation.</p>
<div id="predicting-change" class="section level2">
<h2>predicting change</h2>
<pre class="r"><code>c.mw.model &lt;-
&#39;e7 =~ 1*TPER7_01 + cat6*TPER7_04 + cat2*TPER7_15 + cat3*TPER7_19R + cat4*TPER7_22R
e8 =~ 1*TPER8_01 + cat6*TPER8_04 + cat2*TPER8_15 + cat3*TPER8_19R + cat4*TPER8_22R
e9 =~ 1*TPER9_01 + cat6*TPER9_04 + cat2*TPER9_15 + cat3*TPER9_19R + cat4*TPER9_22R
e10 =~ 1*TPER10_01 + cat6*TPER10_04 + cat2*TPER10_15 + cat3*TPER10_19R + cat4*TPER10_22R


# settting the fixed regressions to 1

e8 ~ 1*e7     
e9 ~ 1*e8  
e10 ~ 1*e9  

# creating the change scores 

c_7.8 =~ 1*e8     
c_8.9 =~ 1*e9 
c_9.10 =~ 1*e10 


# constraint intercepts
e8 ~ 0*1        
e9 ~ 0*1   
e10 ~ 0*1   

# This fixes the variance to 0

e8 ~~ 0*e8     
e9 ~~ 0*e9  
e10 ~~ 0*e10  

# Estimate the intercept of the change score
c_7.8 ~ 1    
c_8.9 ~ 1 
c_9.10 ~ 1             

# This estimates the intercept and variance of initial time
e7 ~  1           
e7 ~~  e7 

#  Estimates the variance of the change scores
c_7.8 ~~ c_7.8    
c_8.9 ~~ c_8.9 
c_9.10 ~~ c_9.10       


# Estimates the covaration with change scores and T1
e7  ~~ c_7.8 + c_8.9 + c_9.10 
c_7.8 ~~ c_8.9 + c_9.10
c_8.9 ~~ c_9.10

## Allow indicators to covary
TPER7_01 ~~ TPER8_01 + TPER9_01 + TPER10_01
TPER8_01 ~~ TPER9_01 + TPER10_01
TPER9_01 ~~ TPER10_01

TPER7_04 ~~ TPER8_04 + TPER9_04 + TPER10_04
TPER8_04 ~~ TPER9_04 + TPER10_04
TPER9_04 ~~ TPER10_04

TPER7_15 ~~ TPER8_15 + TPER9_15 + TPER10_15
TPER8_15 ~~ TPER9_15 + TPER10_15
TPER9_15 ~~ TPER10_15

TPER7_19R ~~ TPER8_19R + TPER9_19R + TPER10_19R
TPER8_19R ~~ TPER9_19R + TPER10_19R
TPER9_19R ~~ TPER10_19R

TPER7_22R ~~ TPER8_22R + TPER9_22R + TPER10_22R
TPER8_22R ~~ TPER9_22R + TPER10_22R
TPER9_22R ~~ TPER10_22R



#scales the items and add measurement invariance

TPER7_01 ~ 0*1
TPER7_04 ~ (nu1)*1
TPER7_15 ~ (nu2)*1
TPER7_19R ~ (nu3)*1
TPER7_22R ~ (nu4)*1

TPER8_01~ 0*1
TPER8_04 ~ (nu1)*1
TPER8_15~ (nu2)*1
TPER8_19R ~ (nu3)*1
TPER8_22R~ (nu4)*1

TPER9_01~ 0*1
TPER9_04 ~ (nu1)*1
TPER9_15~ (nu2)*1
TPER9_19R ~ (nu3)*1
TPER9_22R~ (nu4)*1

TPER10_01 ~ 0*1
TPER10_04 ~ (nu1)*1
TPER10_15 ~ (nu2)*1
TPER10_19R ~ (nu3)*1
TPER10_22R ~ (nu4)*1

# predicting change

c_7.8 ~ SEX1    
c_8.9 ~ SEX1 
c_9.10 ~ SEX1 


&#39;

c.mw.model &lt;- sem(c.mw.model, data=y_t_all , missing=&quot;ML&quot;)</code></pre>
<pre><code>## Warning in lav_data_full(data = data, group = group, cluster = cluster, : lavaan WARNING: 68 cases were deleted due to missing values in 
##        exogenous variable(s), while fixed.x = TRUE.</code></pre>
<pre><code>## Warning in lav_data_full(data = data, group = group, cluster = cluster, :
## lavaan WARNING: due to missing values, some pairwise combinations have less
## than 10% coverage</code></pre>
<pre class="r"><code>summary(c.mw.model, fit.measures=TRUE, standardized=TRUE)</code></pre>
<pre><code>## lavaan 0.6-4 ended normally after 79 iterations
## 
##   Optimization method                           NLMINB
##   Number of free parameters                         99
##   Number of equality constraints                    24
##   Row rank of the constraints matrix                24
## 
##                                                   Used       Total
##   Number of observations                           999        1067
##   Number of missing patterns                        30
## 
##   Estimator                                         ML
##   Model Fit Test Statistic                     871.333
##   Degrees of freedom                               175
##   P-value (Chi-square)                           0.000
## 
## Model test baseline model:
## 
##   Minimum Function Test Statistic             5976.297
##   Degrees of freedom                               210
##   P-value                                        0.000
## 
## User model versus baseline model:
## 
##   Comparative Fit Index (CFI)                    0.879
##   Tucker-Lewis Index (TLI)                       0.855
## 
## Loglikelihood and Information Criteria:
## 
##   Loglikelihood user model (H0)             -11131.232
##   Loglikelihood unrestricted model (H1)     -10695.565
## 
##   Number of free parameters                         75
##   Akaike (AIC)                               22412.463
##   Bayesian (BIC)                             22780.470
##   Sample-size adjusted Bayesian (BIC)        22542.266
## 
## Root Mean Square Error of Approximation:
## 
##   RMSEA                                          0.063
##   90 Percent Confidence Interval          0.059  0.067
##   P-value RMSEA &lt;= 0.05                          0.000
## 
## Standardized Root Mean Square Residual:
## 
##   SRMR                                           0.065
## 
## Parameter Estimates:
## 
##   Information                                 Observed
##   Observed information based on                Hessian
##   Standard Errors                             Standard
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   e7 =~                                                                 
##     TPER7_0           1.000                               1.009    0.872
##     TPER7_0 (cat6)    0.783    0.024   32.145    0.000    0.790    0.724
##     TPER7_1 (cat2)    0.987    0.023   43.539    0.000    0.996    0.854
##     TPER7_1 (cat3)    1.011    0.030   34.231    0.000    1.020    0.766
##     TPER7_2 (cat4)    1.015    0.030   33.472    0.000    1.024    0.754
##   e8 =~                                                                 
##     TPER8_0           1.000                               1.010    0.875
##     TPER8_0 (cat6)    0.783    0.024   32.145    0.000    0.791    0.701
##     TPER8_1 (cat2)    0.987    0.023   43.539    0.000    0.997    0.855
##     TPER8_1 (cat3)    1.011    0.030   34.231    0.000    1.022    0.753
##     TPER8_2 (cat4)    1.015    0.030   33.472    0.000    1.026    0.741
##   e9 =~                                                                 
##     TPER9_0           1.000                               1.037    0.857
##     TPER9_0 (cat6)    0.783    0.024   32.145    0.000    0.813    0.704
##     TPER9_1 (cat2)    0.987    0.023   43.539    0.000    1.024    0.859
##     TPER9_1 (cat3)    1.011    0.030   34.231    0.000    1.049    0.779
##     TPER9_2 (cat4)    1.015    0.030   33.472    0.000    1.053    0.779
##   e10 =~                                                                
##     TPER10_           1.000                               0.971    0.859
##     TPER10_ (cat6)    0.783    0.024   32.145    0.000    0.760    0.685
##     TPER10_ (cat2)    0.987    0.023   43.539    0.000    0.958    0.820
##     TPER10_ (cat3)    1.011    0.030   34.231    0.000    0.981    0.777
##     TPER10_ (cat4)    1.015    0.030   33.472    0.000    0.985    0.775
##   c_7.8 =~                                                              
##     e8                1.000                               1.032    1.032
##   c_8.9 =~                                                              
##     e9                1.000                               0.940    0.940
##   c_9.10 =~                                                             
##     e10               1.000                               1.017    1.017
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   e8 ~                                                                  
##     e7                1.000                               0.998    0.998
##   e9 ~                                                                  
##     e8                1.000                               0.974    0.974
##   e10 ~                                                                 
##     e9                1.000                               1.069    1.069
##   c_7.8 ~                                                               
##     SEX1              0.206    0.086    2.387    0.017    0.197    0.099
##   c_8.9 ~                                                               
##     SEX1              0.067    0.106    0.632    0.527    0.069    0.034
##   c_9.10 ~                                                              
##     SEX1              0.075    0.120    0.626    0.532    0.076    0.038
## 
## Covariances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   e7 ~~                                                                 
##    .c_7.8            -0.542    0.074   -7.359    0.000   -0.518   -0.518
##    .c_8.9             0.110    0.074    1.494    0.135    0.112    0.112
##    .c_9.10           -0.081    0.117   -0.689    0.491   -0.081   -0.081
##  .c_7.8 ~~                                                              
##    .c_8.9            -0.562    0.086   -6.504    0.000   -0.555   -0.555
##    .c_9.10            0.004    0.132    0.033    0.974    0.004    0.004
##  .c_8.9 ~~                                                              
##    .c_9.10           -0.483    0.088   -5.474    0.000   -0.502   -0.502
##  .TPER7_01 ~~                                                           
##    .TPER8_01          0.047    0.029    1.582    0.114    0.047    0.147
##    .TPER9_01          0.084    0.036    2.370    0.018    0.084    0.239
##    .TPER10_01        -0.197    0.052   -3.762    0.000   -0.197   -0.604
##  .TPER8_01 ~~                                                           
##    .TPER9_01          0.069    0.028    2.443    0.015    0.069    0.198
##    .TPER10_01         0.059    0.034    1.747    0.081    0.059    0.183
##  .TPER9_01 ~~                                                           
##    .TPER10_01         0.028    0.035    0.815    0.415    0.028    0.078
##  .TPER7_04 ~~                                                           
##    .TPER8_04          0.162    0.039    4.110    0.000    0.162    0.267
##    .TPER9_04          0.135    0.049    2.782    0.005    0.135    0.219
##    .TPER10_04         0.090    0.098    0.920    0.357    0.090    0.148
##  .TPER8_04 ~~                                                           
##    .TPER9_04          0.213    0.041    5.158    0.000    0.213    0.323
##    .TPER10_04         0.092    0.056    1.630    0.103    0.092    0.141
##  .TPER9_04 ~~                                                           
##    .TPER10_04         0.224    0.050    4.459    0.000    0.224    0.338
##  .TPER7_15 ~~                                                           
##    .TPER8_15          0.022    0.030    0.733    0.464    0.022    0.060
##    .TPER9_15          0.005    0.034    0.137    0.891    0.005    0.012
##    .TPER10_15        -0.130    0.069   -1.886    0.059   -0.130   -0.321
##  .TPER8_15 ~~                                                           
##    .TPER9_15          0.026    0.028    0.918    0.359    0.026    0.069
##    .TPER10_15         0.015    0.040    0.366    0.714    0.015    0.037
##  .TPER9_15 ~~                                                           
##    .TPER10_15         0.030    0.034    0.863    0.388    0.030    0.072
##  .TPER7_19R ~~                                                          
##    .TPER8_19R         0.108    0.055    1.948    0.051    0.108    0.141
##    .TPER9_19R        -0.073    0.060   -1.205    0.228   -0.073   -0.101
##    .TPER10_19R        0.193    0.093    2.071    0.038    0.193    0.284
##  .TPER8_19R ~~                                                          
##    .TPER9_19R         0.111    0.054    2.046    0.041    0.111    0.146
##    .TPER10_19R        0.053    0.070    0.763    0.445    0.053    0.075
##  .TPER9_19R ~~                                                          
##    .TPER10_19R       -0.054    0.056   -0.970    0.332   -0.054   -0.081
##  .TPER7_22R ~~                                                          
##    .TPER8_22R         0.145    0.060    2.423    0.015    0.145    0.175
##    .TPER9_22R         0.021    0.060    0.348    0.728    0.021    0.028
##    .TPER10_22R        0.165    0.107    1.538    0.124    0.165    0.230
##  .TPER8_22R ~~                                                          
##    .TPER9_22R         0.049    0.052    0.944    0.345    0.049    0.062
##    .TPER10_22R       -0.011    0.062   -0.182    0.856   -0.011   -0.015
##  .TPER9_22R ~~                                                          
##    .TPER10_22R        0.050    0.057    0.874    0.382    0.050    0.073
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .e8                0.000                               0.000    0.000
##    .e9                0.000                               0.000    0.000
##    .e10               0.000                               0.000    0.000
##    .c_7.8            -0.325    0.142   -2.284    0.022   -0.312   -0.312
##    .c_8.9            -0.104    0.166   -0.628    0.530   -0.107   -0.107
##    .c_9.10            0.008    0.190    0.041    0.968    0.008    0.008
##     e7                3.689    0.051   72.452    0.000    3.657    3.657
##    .TPER7_01          0.000                               0.000    0.000
##    .TPER7_04 (nu1)    0.613    0.094    6.526    0.000    0.613    0.562
##    .TPER7_15 (nu2)   -0.061    0.087   -0.703    0.482   -0.061   -0.053
##    .TPER7_19 (nu3)   -0.433    0.113   -3.837    0.000   -0.433   -0.325
##    .TPER7_22 (nu4)   -0.547    0.116   -4.719    0.000   -0.547   -0.402
##    .TPER8_01          0.000                               0.000    0.000
##    .TPER8_04 (nu1)    0.613    0.094    6.526    0.000    0.613    0.543
##    .TPER8_15 (nu2)   -0.061    0.087   -0.703    0.482   -0.061   -0.053
##    .TPER8_19 (nu3)   -0.433    0.113   -3.837    0.000   -0.433   -0.319
##    .TPER8_22 (nu4)   -0.547    0.116   -4.719    0.000   -0.547   -0.395
##    .TPER9_01          0.000                               0.000    0.000
##    .TPER9_04 (nu1)    0.613    0.094    6.526    0.000    0.613    0.531
##    .TPER9_15 (nu2)   -0.061    0.087   -0.703    0.482   -0.061   -0.051
##    .TPER9_19 (nu3)   -0.433    0.113   -3.837    0.000   -0.433   -0.322
##    .TPER9_22 (nu4)   -0.547    0.116   -4.719    0.000   -0.547   -0.404
##    .TPER10_0          0.000                               0.000    0.000
##    .TPER10_0 (nu1)    0.613    0.094    6.526    0.000    0.613    0.552
##    .TPER10_1 (nu2)   -0.061    0.087   -0.703    0.482   -0.061   -0.052
##    .TPER10_1 (nu3)   -0.433    0.113   -3.837    0.000   -0.433   -0.343
##    .TPER10_2 (nu4)   -0.547    0.116   -4.719    0.000   -0.547   -0.430
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .e8                0.000                               0.000    0.000
##    .e9                0.000                               0.000    0.000
##    .e10               0.000                               0.000    0.000
##     e7                1.018    0.084   12.144    0.000    1.000    1.000
##    .c_7.8             1.078    0.110    9.814    0.000    0.990    0.990
##    .c_8.9             0.951    0.099    9.632    0.000    0.999    0.999
##    .c_9.10            0.973    0.108    9.011    0.000    0.999    0.999
##    .TPER7_01          0.320    0.035    9.025    0.000    0.320    0.239
##    .TPER7_04          0.568    0.046   12.254    0.000    0.568    0.476
##    .TPER7_15          0.368    0.035   10.392    0.000    0.368    0.271
##    .TPER7_19R         0.732    0.063   11.631    0.000    0.732    0.413
##    .TPER7_22R         0.798    0.067   11.857    0.000    0.798    0.432
##    .TPER8_01          0.313    0.030   10.313    0.000    0.313    0.235
##    .TPER8_04          0.648    0.046   14.180    0.000    0.648    0.508
##    .TPER8_15          0.366    0.032   11.610    0.000    0.366    0.269
##    .TPER8_19R         0.798    0.060   13.376    0.000    0.798    0.433
##    .TPER8_22R         0.863    0.064   13.515    0.000    0.863    0.451
##    .TPER9_01          0.388    0.035   10.934    0.000    0.388    0.265
##    .TPER9_04          0.672    0.048   13.878    0.000    0.672    0.505
##    .TPER9_15          0.374    0.034   11.144    0.000    0.374    0.263
##    .TPER9_19R         0.714    0.057   12.438    0.000    0.714    0.394
##    .TPER9_22R         0.720    0.058   12.462    0.000    0.720    0.394
##    .TPER10_01         0.334    0.040    8.302    0.000    0.334    0.262
##    .TPER10_04         0.655    0.060   10.998    0.000    0.655    0.531
##    .TPER10_15         0.447    0.047    9.528    0.000    0.447    0.327
##    .TPER10_19R        0.630    0.064    9.904    0.000    0.630    0.396
##    .TPER10_22R        0.644    0.065    9.844    0.000    0.644    0.399</code></pre>
</div>
<div id="adding-intercept-and-growth-factors-to-lds-models" class="section level2">
<h2>adding intercept and growth factors to LDS models</h2>
<p>One top of this type of model you can fit a growth curve. Why? Can capture both general trends and more fine-grained temporal dynamics. This can be especially useful when trying to separate a known, more stable change occurring during development (e.g.natural aging process) from more specific fluctuations due to external factors (e.g., life events).</p>
<p>However, there are some differences from our standard latent growth model. First, if the difference scores are equal across time the mean of the change factor will be 0. This is because the latent change variable are using difference scores as indicators, not standard indicators. As such, this can be interpreted as a constant rate of change (or not).</p>
<p>If you want to get at a standard interpretation of a growth curve, seperate from change at a specific time point, you can define the change score with loadings of 1 for all difference score variables as opposed to increasing linearly eg 1,2,3,4,5…</p>
<pre class="r"><code>lg.mw.model &lt;-
&#39;e7 =~ 1*TPER7_01 + cat6*TPER7_04 + cat2*TPER7_15 + cat3*TPER7_19R + cat4*TPER7_22R
e8 =~ 1*TPER8_01 + cat6*TPER8_04 + cat2*TPER8_15 + cat3*TPER8_19R + cat4*TPER8_22R
e9 =~ 1*TPER9_01 + cat6*TPER9_04 + cat2*TPER9_15 + cat3*TPER9_19R + cat4*TPER9_22R
e10 =~ 1*TPER10_01 + cat6*TPER10_04 + cat2*TPER10_15 + cat3*TPER10_19R + cat4*TPER10_22R


# settting the fixed regressions to 1

e8 ~ 1*e7     
e9 ~ 1*e8  
e10 ~ 1*e9  

# creating the change scores 

c_7.8 =~ 1*e8     
c_8.9 =~ 1*e9 
c_9.10 =~ 1*e10 


# constraint intercepts
e8 ~ 0*1        
e9 ~ 0*1   
e10 ~ 0*1   

# This fixes the variance to 0

e8 ~~ 0*e8     
e9 ~~ 0*e9  
e10 ~~ 0*e10  

# # a change from the previous models is we now fix the mean of change scores to zero. Estimate the intercept of the change score
c_7.8 ~ 0*1    
c_8.9 ~ 0*1 
c_9.10 ~ 0*1             

# This estimates the intercept and variance of initial time
e7 ~  1           
e7 ~~  e7 

#  Estimates the variance of the change scores
c_7.8 ~~ c_7.8    
c_8.9 ~~ c_8.9 
c_9.10 ~~ c_9.10       


# # A change from the previous model is we no longer estimate the covariance between change scores a) with eachother and b) with the intercept. We will only covary intercept with a growth component, defined below. We must set some of these covariances to zero to make sure they are not estimated.  
e7  ~~ 0*c_7.8 + 0*c_8.9 + 0*c_9.10
c_7.8 ~~ 0*c_8.9 + 0*c_9.10
c_8.9 ~~ 0*c_9.10


## Allow indicators to covary
TPER7_01 ~~ TPER8_01 + TPER9_01 + TPER10_01
TPER8_01 ~~ TPER9_01 + TPER10_01
TPER9_01 ~~ TPER10_01

TPER7_04 ~~ TPER8_04 + TPER9_04 + TPER10_04
TPER8_04 ~~ TPER9_04 + TPER10_04
TPER9_04 ~~ TPER10_04

TPER7_15 ~~ TPER8_15 + TPER9_15 + TPER10_15
TPER8_15 ~~ TPER9_15 + TPER10_15
TPER9_15 ~~ TPER10_15

TPER7_19R ~~ TPER8_19R + TPER9_19R + TPER10_19R
TPER8_19R ~~ TPER9_19R + TPER10_19R
TPER9_19R ~~ TPER10_19R

TPER7_22R ~~ TPER8_22R + TPER9_22R + TPER10_22R
TPER8_22R ~~ TPER9_22R + TPER10_22R
TPER9_22R ~~ TPER10_22R



#scales the items and add measurement invariance

TPER7_01 ~ 0*1
TPER7_04 ~ (nu1)*1
TPER7_15 ~ (nu2)*1
TPER7_19R ~ (nu3)*1
TPER7_22R ~ (nu4)*1

TPER8_01~ 0*1
TPER8_04 ~ (nu1)*1
TPER8_15~ (nu2)*1
TPER8_19R ~ (nu3)*1
TPER8_22R~ (nu4)*1

TPER9_01~ 0*1
TPER9_04 ~ (nu1)*1
TPER9_15~ (nu2)*1
TPER9_19R ~ (nu3)*1
TPER9_22R~ (nu4)*1

TPER10_01 ~ 0*1
TPER10_04 ~ (nu1)*1
TPER10_15 ~ (nu2)*1
TPER10_19R ~ (nu3)*1
TPER10_22R ~ (nu4)*1

# create a latent intercept growth component
E.change  =~ 1*e8 + 2*e9 + 3*e10
E.change ~ 1

# Covary the intecept and new overall change component and make sure change does not covary with difference scores
E.change ~~ e7
E.change ~~ 0*c_7.8 + 0*c_8.9 + 0*c_9.10

&#39;

lg.mw.model &lt;- sem(lg.mw.model, data=y_t_all , missing=&quot;ML&quot;)</code></pre>
<pre><code>## Warning in lav_data_full(data = data, group = group, cluster = cluster, : lavaan WARNING: some cases are empty and will be ignored:
##   14 24 32 33 34 36 37 39 48 49 51 57 76 78 80 83 84 86 90 91 98 109 119 129 130 131 140 144 145 157 165 167 170 171 177 180 182 183 190 206 222 227 229 234 247 250 260 287 292 295 301 302 307 327 339 342 345 349 354 356 359 360 369 370 377 383 384 386 393 406 411 414 419 421 422 425 426 429 440 442 446 448 449 450 456 460 462 470 473 476 485 491 494 496 503 504 507 508 516 532 535 539 546 547 548 552 554 555 556 559 561 563 566 571 584 586 587 591 596 599 601 607 620 630 634 635 642 645 650 651 658 666 673 678 687 716 718 732 735 737 738 740 745 751 761 766 776 785 786 788 790 795 796 802 804 823 827 831 842 847 851 853 860 887 892 901 920 923 926 927 936 938 940 947 949 952 953 955 956 957 969 972 977 979 981 985 993 999 1000 1003 1016 1029 1032 1035 1038 1040 1044 1046 1048 1050 1055 1059 1066</code></pre>
<pre><code>## Warning in lav_data_full(data = data, group = group, cluster = cluster, :
## lavaan WARNING: due to missing values, some pairwise combinations have less
## than 10% coverage</code></pre>
<pre><code>## Warning in lav_object_post_check(object): lavaan WARNING: some estimated lv
## variances are negative</code></pre>
<pre class="r"><code>summary(lg.mw.model, fit.measures=TRUE)</code></pre>
<pre><code>## lavaan 0.6-4 ended normally after 63 iterations
## 
##   Optimization method                           NLMINB
##   Number of free parameters                         90
##   Number of equality constraints                    24
##   Row rank of the constraints matrix                24
## 
##                                                   Used       Total
##   Number of observations                           864        1067
##   Number of missing patterns                        29
## 
##   Estimator                                         ML
##   Model Fit Test Statistic                     949.774
##   Degrees of freedom                               164
##   P-value (Chi-square)                           0.000
## 
## Model test baseline model:
## 
##   Minimum Function Test Statistic             6120.154
##   Degrees of freedom                               190
##   P-value                                        0.000
## 
## User model versus baseline model:
## 
##   Comparative Fit Index (CFI)                    0.867
##   Tucker-Lewis Index (TLI)                       0.846
## 
## Loglikelihood and Information Criteria:
## 
##   Loglikelihood user model (H0)             -11736.787
##   Loglikelihood unrestricted model (H1)     -11261.900
## 
##   Number of free parameters                         66
##   Akaike (AIC)                               23605.574
##   Bayesian (BIC)                             23919.837
##   Sample-size adjusted Bayesian (BIC)        23710.238
## 
## Root Mean Square Error of Approximation:
## 
##   RMSEA                                          0.074
##   90 Percent Confidence Interval          0.070  0.079
##   P-value RMSEA &lt;= 0.05                          0.000
## 
## Standardized Root Mean Square Residual:
## 
##   SRMR                                           0.156
## 
## Parameter Estimates:
## 
##   Information                                 Observed
##   Observed information based on                Hessian
##   Standard Errors                             Standard
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   e7 =~                                               
##     TPER7_0           1.000                           
##     TPER7_0 (cat6)    0.790    0.024   32.432    0.000
##     TPER7_1 (cat2)    0.986    0.022   43.857    0.000
##     TPER7_1 (cat3)    1.024    0.029   35.060    0.000
##     TPER7_2 (cat4)    1.024    0.030   34.275    0.000
##   e8 =~                                               
##     TPER8_0           1.000                           
##     TPER8_0 (cat6)    0.790    0.024   32.432    0.000
##     TPER8_1 (cat2)    0.986    0.022   43.857    0.000
##     TPER8_1 (cat3)    1.024    0.029   35.060    0.000
##     TPER8_2 (cat4)    1.024    0.030   34.275    0.000
##   e9 =~                                               
##     TPER9_0           1.000                           
##     TPER9_0 (cat6)    0.790    0.024   32.432    0.000
##     TPER9_1 (cat2)    0.986    0.022   43.857    0.000
##     TPER9_1 (cat3)    1.024    0.029   35.060    0.000
##     TPER9_2 (cat4)    1.024    0.030   34.275    0.000
##   e10 =~                                              
##     TPER10_           1.000                           
##     TPER10_ (cat6)    0.790    0.024   32.432    0.000
##     TPER10_ (cat2)    0.986    0.022   43.857    0.000
##     TPER10_ (cat3)    1.024    0.029   35.060    0.000
##     TPER10_ (cat4)    1.024    0.030   34.275    0.000
##   c_7.8 =~                                            
##     e8                1.000                           
##   c_8.9 =~                                            
##     e9                1.000                           
##   c_9.10 =~                                           
##     e10               1.000                           
##   E.change =~                                         
##     e8                1.000                           
##     e9                2.000                           
##     e10               3.000                           
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   e8 ~                                                
##     e7                1.000                           
##   e9 ~                                                
##     e8                1.000                           
##   e10 ~                                               
##     e9                1.000                           
## 
## Covariances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   e7 ~~                                               
##     c_7.8             0.000                           
##     c_8.9             0.000                           
##     c_9.10            0.000                           
##   c_7.8 ~~                                            
##     c_8.9             0.000                           
##     c_9.10            0.000                           
##   c_8.9 ~~                                            
##     c_9.10            0.000                           
##  .TPER7_01 ~~                                         
##    .TPER8_01          0.018    0.030    0.586    0.558
##    .TPER9_01          0.090    0.036    2.505    0.012
##    .TPER10_01        -0.204    0.053   -3.819    0.000
##  .TPER8_01 ~~                                         
##    .TPER9_01          0.072    0.028    2.569    0.010
##    .TPER10_01         0.067    0.036    1.868    0.062
##  .TPER9_01 ~~                                         
##    .TPER10_01         0.028    0.034    0.838    0.402
##  .TPER7_04 ~~                                         
##    .TPER8_04          0.149    0.040    3.766    0.000
##    .TPER9_04          0.150    0.051    2.936    0.003
##    .TPER10_04         0.109    0.096    1.134    0.257
##  .TPER8_04 ~~                                         
##    .TPER9_04          0.222    0.043    5.209    0.000
##    .TPER10_04         0.085    0.054    1.585    0.113
##  .TPER9_04 ~~                                         
##    .TPER10_04         0.203    0.048    4.251    0.000
##  .TPER7_15 ~~                                         
##    .TPER8_15          0.007    0.030    0.234    0.815
##    .TPER9_15          0.009    0.034    0.270    0.787
##    .TPER10_15        -0.137    0.072   -1.904    0.057
##  .TPER8_15 ~~                                         
##    .TPER9_15          0.025    0.028    0.898    0.369
##    .TPER10_15         0.016    0.042    0.388    0.698
##  .TPER9_15 ~~                                         
##    .TPER10_15         0.010    0.033    0.294    0.769
##  .TPER7_19R ~~                                        
##    .TPER8_19R         0.111    0.054    2.034    0.042
##    .TPER9_19R        -0.062    0.060   -1.032    0.302
##    .TPER10_19R        0.179    0.093    1.925    0.054
##  .TPER8_19R ~~                                        
##    .TPER9_19R         0.104    0.053    1.972    0.049
##    .TPER10_19R        0.050    0.069    0.728    0.467
##  .TPER9_19R ~~                                        
##    .TPER10_19R       -0.037    0.052   -0.714    0.475
##  .TPER7_22R ~~                                        
##    .TPER8_22R         0.144    0.059    2.443    0.015
##    .TPER9_22R         0.026    0.061    0.427    0.670
##    .TPER10_22R        0.141    0.109    1.293    0.196
##  .TPER8_22R ~~                                        
##    .TPER9_22R         0.041    0.052    0.784    0.433
##    .TPER10_22R       -0.010    0.062   -0.167    0.867
##  .TPER9_22R ~~                                        
##    .TPER10_22R        0.020    0.054    0.375    0.707
##   e7 ~~                                               
##     E.change         -0.092    0.016   -5.901    0.000
##   c_7.8 ~~                                            
##     E.change          0.000                           
##   c_8.9 ~~                                            
##     E.change          0.000                           
##   c_9.10 ~~                                           
##     E.change          0.000                           
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##    .e8                0.000                           
##    .e9                0.000                           
##    .e10               0.000                           
##     c_7.8             0.000                           
##     c_8.9             0.000                           
##     c_9.10            0.000                           
##     e7                3.668    0.043   84.664    0.000
##    .TPER7_01          0.000                           
##    .TPER7_04 (nu1)    0.572    0.094    6.114    0.000
##    .TPER7_15 (nu2)   -0.058    0.086   -0.676    0.499
##    .TPER7_19 (nu3)   -0.477    0.111   -4.287    0.000
##    .TPER7_22 (nu4)   -0.587    0.114   -5.159    0.000
##    .TPER8_01          0.000                           
##    .TPER8_04 (nu1)    0.572    0.094    6.114    0.000
##    .TPER8_15 (nu2)   -0.058    0.086   -0.676    0.499
##    .TPER8_19 (nu3)   -0.477    0.111   -4.287    0.000
##    .TPER8_22 (nu4)   -0.587    0.114   -5.159    0.000
##    .TPER9_01          0.000                           
##    .TPER9_04 (nu1)    0.572    0.094    6.114    0.000
##    .TPER9_15 (nu2)   -0.058    0.086   -0.676    0.499
##    .TPER9_19 (nu3)   -0.477    0.111   -4.287    0.000
##    .TPER9_22 (nu4)   -0.587    0.114   -5.159    0.000
##    .TPER10_0          0.000                           
##    .TPER10_0 (nu1)    0.572    0.094    6.114    0.000
##    .TPER10_1 (nu2)   -0.058    0.086   -0.676    0.499
##    .TPER10_1 (nu3)   -0.477    0.111   -4.287    0.000
##    .TPER10_2 (nu4)   -0.587    0.114   -5.159    0.000
##     E.change          0.015    0.010    1.448    0.148
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##    .e8                0.000                           
##    .e9                0.000                           
##    .e10               0.000                           
##     e7                0.869    0.066   13.069    0.000
##     c_7.8             0.712    0.059   12.107    0.000
##     c_8.9             1.094    0.096   11.395    0.000
##     c_9.10            1.997    0.206    9.674    0.000
##    .TPER7_01          0.338    0.036    9.411    0.000
##    .TPER7_04          0.575    0.047   12.274    0.000
##    .TPER7_15          0.378    0.036   10.549    0.000
##    .TPER7_19R         0.742    0.063   11.779    0.000
##    .TPER7_22R         0.807    0.067   12.024    0.000
##    .TPER8_01          0.338    0.031   10.782    0.000
##    .TPER8_04          0.654    0.046   14.228    0.000
##    .TPER8_15          0.366    0.031   11.648    0.000
##    .TPER8_19R         0.778    0.058   13.327    0.000
##    .TPER8_22R         0.853    0.063   13.538    0.000
##    .TPER9_01          0.384    0.034   11.214    0.000
##    .TPER9_04          0.713    0.049   14.497    0.000
##    .TPER9_15          0.383    0.033   11.611    0.000
##    .TPER9_19R         0.701    0.055   12.752    0.000
##    .TPER9_22R         0.720    0.056   12.846    0.000
##    .TPER10_01         0.347    0.039    8.916    0.000
##    .TPER10_04         0.616    0.053   11.551    0.000
##    .TPER10_15         0.464    0.045   10.233    0.000
##    .TPER10_19R        0.610    0.059   10.367    0.000
##    .TPER10_22R        0.639    0.061   10.398    0.000
##     E.change         -0.074    0.010   -7.106    0.000</code></pre>
<p>Now lets try this same model but with equal loadings on our general change factor.</p>
<pre class="r"><code>e.lg.mw.model &lt;-
&#39;e7 =~ 1*TPER7_01 + cat6*TPER7_04 + cat2*TPER7_15 + cat3*TPER7_19R + cat4*TPER7_22R
e8 =~ 1*TPER8_01 + cat6*TPER8_04 + cat2*TPER8_15 + cat3*TPER8_19R + cat4*TPER8_22R
e9 =~ 1*TPER9_01 + cat6*TPER9_04 + cat2*TPER9_15 + cat3*TPER9_19R + cat4*TPER9_22R
e10 =~ 1*TPER10_01 + cat6*TPER10_04 + cat2*TPER10_15 + cat3*TPER10_19R + cat4*TPER10_22R


# settting the fixed regressions to 1

e8 ~ 1*e7     
e9 ~ 1*e8  
e10 ~ 1*e9  

# creating the change scores 

c_7.8 =~ 1*e8     
c_8.9 =~ 1*e9 
c_9.10 =~ 1*e10 


# constraint intercepts
e8 ~ 0*1        
e9 ~ 0*1   
e10 ~ 0*1   

# This fixes the variance to 0

e8 ~~ 0*e8     
e9 ~~ 0*e9  
e10 ~~ 0*e10  

# Estimate the intercept of the change scores
c_7.8 ~ 0*1    
c_8.9 ~ 0*1 
c_9.10 ~ 0*1             

# This estimates the intercept and variance of initial time
e7 ~  1           
e7 ~~  e7 

#  Estimates the variance of the change scores
c_7.8 ~~ c_7.8    
c_8.9 ~~ c_8.9 
c_9.10 ~~ c_9.10       


# # A change from the previous model is we no longer estimate the covariance between change scores a) with eachother and b) with the intercept. We will only covary intercept with a growth component, defined below. We must set some of these covariances to zero to make sure they are not estimated.  
e7  ~~ 0*c_7.8 + 0*c_8.9 + 0*c_9.10
c_7.8 ~~ 0*c_8.9 + 0*c_9.10
c_8.9 ~~ 0*c_9.10


## Allow indicators to covary
TPER7_01 ~~ TPER8_01 + TPER9_01 + TPER10_01
TPER8_01 ~~ TPER9_01 + TPER10_01
TPER9_01 ~~ TPER10_01

TPER7_04 ~~ TPER8_04 + TPER9_04 + TPER10_04
TPER8_04 ~~ TPER9_04 + TPER10_04
TPER9_04 ~~ TPER10_04

TPER7_15 ~~ TPER8_15 + TPER9_15 + TPER10_15
TPER8_15 ~~ TPER9_15 + TPER10_15
TPER9_15 ~~ TPER10_15

TPER7_19R ~~ TPER8_19R + TPER9_19R + TPER10_19R
TPER8_19R ~~ TPER9_19R + TPER10_19R
TPER9_19R ~~ TPER10_19R

TPER7_22R ~~ TPER8_22R + TPER9_22R + TPER10_22R
TPER8_22R ~~ TPER9_22R + TPER10_22R
TPER9_22R ~~ TPER10_22R



#scales the items and add measurement invariance

TPER7_01 ~ 0*1
TPER7_04 ~ (nu1)*1
TPER7_15 ~ (nu2)*1
TPER7_19R ~ (nu3)*1
TPER7_22R ~ (nu4)*1

TPER8_01~ 0*1
TPER8_04 ~ (nu1)*1
TPER8_15~ (nu2)*1
TPER8_19R ~ (nu3)*1
TPER8_22R~ (nu4)*1

TPER9_01~ 0*1
TPER9_04 ~ (nu1)*1
TPER9_15~ (nu2)*1
TPER9_19R ~ (nu3)*1
TPER9_22R~ (nu4)*1

TPER10_01 ~ 0*1
TPER10_04 ~ (nu1)*1
TPER10_15 ~ (nu2)*1
TPER10_19R ~ (nu3)*1
TPER10_22R ~ (nu4)*1

# create a latent intercept growth component
E.change  =~ 1*e8 + 1*e9 + 1*e10
E.change ~ 1

# Covary the intecept and new overall change component and make sure change does not covary with difference scores
E.change ~~ e7
E.change ~~ 0*c_7.8 + 0*c_8.9 + 0*c_9.10

&#39;

e.lg.mw.model &lt;- sem(e.lg.mw.model, data=y_t_all , missing=&quot;ML&quot;)</code></pre>
<pre><code>## Warning in lav_data_full(data = data, group = group, cluster = cluster, : lavaan WARNING: some cases are empty and will be ignored:
##   14 24 32 33 34 36 37 39 48 49 51 57 76 78 80 83 84 86 90 91 98 109 119 129 130 131 140 144 145 157 165 167 170 171 177 180 182 183 190 206 222 227 229 234 247 250 260 287 292 295 301 302 307 327 339 342 345 349 354 356 359 360 369 370 377 383 384 386 393 406 411 414 419 421 422 425 426 429 440 442 446 448 449 450 456 460 462 470 473 476 485 491 494 496 503 504 507 508 516 532 535 539 546 547 548 552 554 555 556 559 561 563 566 571 584 586 587 591 596 599 601 607 620 630 634 635 642 645 650 651 658 666 673 678 687 716 718 732 735 737 738 740 745 751 761 766 776 785 786 788 790 795 796 802 804 823 827 831 842 847 851 853 860 887 892 901 920 923 926 927 936 938 940 947 949 952 953 955 956 957 969 972 977 979 981 985 993 999 1000 1003 1016 1029 1032 1035 1038 1040 1044 1046 1048 1050 1055 1059 1066</code></pre>
<pre><code>## Warning in lav_data_full(data = data, group = group, cluster = cluster, :
## lavaan WARNING: due to missing values, some pairwise combinations have less
## than 10% coverage</code></pre>
<pre><code>## Warning in lav_object_post_check(object): lavaan WARNING: some estimated lv
## variances are negative</code></pre>
<pre class="r"><code>summary(e.lg.mw.model, fit.measures=TRUE)</code></pre>
<pre><code>## lavaan 0.6-4 ended normally after 59 iterations
## 
##   Optimization method                           NLMINB
##   Number of free parameters                         90
##   Number of equality constraints                    24
##   Row rank of the constraints matrix                24
## 
##                                                   Used       Total
##   Number of observations                           864        1067
##   Number of missing patterns                        29
## 
##   Estimator                                         ML
##   Model Fit Test Statistic                     897.471
##   Degrees of freedom                               164
##   P-value (Chi-square)                           0.000
## 
## Model test baseline model:
## 
##   Minimum Function Test Statistic             6120.154
##   Degrees of freedom                               190
##   P-value                                        0.000
## 
## User model versus baseline model:
## 
##   Comparative Fit Index (CFI)                    0.876
##   Tucker-Lewis Index (TLI)                       0.857
## 
## Loglikelihood and Information Criteria:
## 
##   Loglikelihood user model (H0)             -11710.635
##   Loglikelihood unrestricted model (H1)     -11261.900
## 
##   Number of free parameters                         66
##   Akaike (AIC)                               23553.270
##   Bayesian (BIC)                             23867.534
##   Sample-size adjusted Bayesian (BIC)        23657.935
## 
## Root Mean Square Error of Approximation:
## 
##   RMSEA                                          0.072
##   90 Percent Confidence Interval          0.067  0.077
##   P-value RMSEA &lt;= 0.05                          0.000
## 
## Standardized Root Mean Square Residual:
## 
##   SRMR                                           0.124
## 
## Parameter Estimates:
## 
##   Information                                 Observed
##   Observed information based on                Hessian
##   Standard Errors                             Standard
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   e7 =~                                               
##     TPER7_0           1.000                           
##     TPER7_0 (cat6)    0.791    0.024   32.656    0.000
##     TPER7_1 (cat2)    0.987    0.022   44.101    0.000
##     TPER7_1 (cat3)    1.023    0.029   35.086    0.000
##     TPER7_2 (cat4)    1.024    0.030   34.249    0.000
##   e8 =~                                               
##     TPER8_0           1.000                           
##     TPER8_0 (cat6)    0.791    0.024   32.656    0.000
##     TPER8_1 (cat2)    0.987    0.022   44.101    0.000
##     TPER8_1 (cat3)    1.023    0.029   35.086    0.000
##     TPER8_2 (cat4)    1.024    0.030   34.249    0.000
##   e9 =~                                               
##     TPER9_0           1.000                           
##     TPER9_0 (cat6)    0.791    0.024   32.656    0.000
##     TPER9_1 (cat2)    0.987    0.022   44.101    0.000
##     TPER9_1 (cat3)    1.023    0.029   35.086    0.000
##     TPER9_2 (cat4)    1.024    0.030   34.249    0.000
##   e10 =~                                              
##     TPER10_           1.000                           
##     TPER10_ (cat6)    0.791    0.024   32.656    0.000
##     TPER10_ (cat2)    0.987    0.022   44.101    0.000
##     TPER10_ (cat3)    1.023    0.029   35.086    0.000
##     TPER10_ (cat4)    1.024    0.030   34.249    0.000
##   c_7.8 =~                                            
##     e8                1.000                           
##   c_8.9 =~                                            
##     e9                1.000                           
##   c_9.10 =~                                           
##     e10               1.000                           
##   E.change =~                                         
##     e8                1.000                           
##     e9                1.000                           
##     e10               1.000                           
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   e8 ~                                                
##     e7                1.000                           
##   e9 ~                                                
##     e8                1.000                           
##   e10 ~                                               
##     e9                1.000                           
## 
## Covariances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   e7 ~~                                               
##     c_7.8             0.000                           
##     c_8.9             0.000                           
##     c_9.10            0.000                           
##   c_7.8 ~~                                            
##     c_8.9             0.000                           
##     c_9.10            0.000                           
##   c_8.9 ~~                                            
##     c_9.10            0.000                           
##  .TPER7_01 ~~                                         
##    .TPER8_01          0.029    0.030    0.970    0.332
##    .TPER9_01          0.090    0.036    2.509    0.012
##    .TPER10_01        -0.201    0.053   -3.763    0.000
##  .TPER8_01 ~~                                         
##    .TPER9_01          0.073    0.028    2.590    0.010
##    .TPER10_01         0.064    0.036    1.809    0.071
##  .TPER9_01 ~~                                         
##    .TPER10_01         0.024    0.034    0.719    0.472
##  .TPER7_04 ~~                                         
##    .TPER8_04          0.153    0.039    3.895    0.000
##    .TPER9_04          0.147    0.051    2.897    0.004
##    .TPER10_04         0.103    0.096    1.073    0.283
##  .TPER8_04 ~~                                         
##    .TPER9_04          0.222    0.043    5.227    0.000
##    .TPER10_04         0.084    0.054    1.575    0.115
##  .TPER9_04 ~~                                         
##    .TPER10_04         0.204    0.048    4.276    0.000
##  .TPER7_15 ~~                                         
##    .TPER8_15          0.012    0.030    0.418    0.676
##    .TPER9_15          0.008    0.034    0.249    0.804
##    .TPER10_15        -0.135    0.071   -1.891    0.059
##  .TPER8_15 ~~                                         
##    .TPER9_15          0.026    0.028    0.939    0.348
##    .TPER10_15         0.019    0.042    0.460    0.645
##  .TPER9_15 ~~                                         
##    .TPER10_15         0.011    0.033    0.322    0.747
##  .TPER7_19R ~~                                        
##    .TPER8_19R         0.113    0.055    2.052    0.040
##    .TPER9_19R        -0.066    0.060   -1.087    0.277
##    .TPER10_19R        0.177    0.093    1.890    0.059
##  .TPER8_19R ~~                                        
##    .TPER9_19R         0.107    0.053    2.030    0.042
##    .TPER10_19R        0.058    0.069    0.835    0.404
##  .TPER9_19R ~~                                        
##    .TPER10_19R       -0.038    0.052   -0.734    0.463
##  .TPER7_22R ~~                                        
##    .TPER8_22R         0.148    0.059    2.502    0.012
##    .TPER9_22R         0.025    0.061    0.401    0.688
##    .TPER10_22R        0.138    0.109    1.268    0.205
##  .TPER8_22R ~~                                        
##    .TPER9_22R         0.044    0.052    0.842    0.400
##    .TPER10_22R       -0.006    0.062   -0.093    0.926
##  .TPER9_22R ~~                                        
##    .TPER10_22R        0.018    0.054    0.343    0.732
##   e7 ~~                                               
##     E.change         -0.202    0.031   -6.451    0.000
##   c_7.8 ~~                                            
##     E.change          0.000                           
##   c_8.9 ~~                                            
##     E.change          0.000                           
##   c_9.10 ~~                                           
##     E.change          0.000                           
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##    .e8                0.000                           
##    .e9                0.000                           
##    .e10               0.000                           
##     c_7.8             0.000                           
##     c_8.9             0.000                           
##     c_9.10            0.000                           
##     e7                3.671    0.047   78.914    0.000
##    .TPER7_01          0.000                           
##    .TPER7_04 (nu1)    0.571    0.093    6.133    0.000
##    .TPER7_15 (nu2)   -0.062    0.086   -0.720    0.472
##    .TPER7_19 (nu3)   -0.475    0.111   -4.276    0.000
##    .TPER7_22 (nu4)   -0.588    0.114   -5.159    0.000
##    .TPER8_01          0.000                           
##    .TPER8_04 (nu1)    0.571    0.093    6.133    0.000
##    .TPER8_15 (nu2)   -0.062    0.086   -0.720    0.472
##    .TPER8_19 (nu3)   -0.475    0.111   -4.276    0.000
##    .TPER8_22 (nu4)   -0.588    0.114   -5.159    0.000
##    .TPER9_01          0.000                           
##    .TPER9_04 (nu1)    0.571    0.093    6.133    0.000
##    .TPER9_15 (nu2)   -0.062    0.086   -0.720    0.472
##    .TPER9_19 (nu3)   -0.475    0.111   -4.276    0.000
##    .TPER9_22 (nu4)   -0.588    0.114   -5.159    0.000
##    .TPER10_0          0.000                           
##    .TPER10_0 (nu1)    0.571    0.093    6.133    0.000
##    .TPER10_1 (nu2)   -0.062    0.086   -0.720    0.472
##    .TPER10_1 (nu3)   -0.475    0.111   -4.276    0.000
##    .TPER10_2 (nu4)   -0.588    0.114   -5.159    0.000
##     E.change          0.019    0.021    0.917    0.359
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##    .e8                0.000                           
##    .e9                0.000                           
##    .e10               0.000                           
##     e7                0.939    0.074   12.627    0.000
##     c_7.8             1.003    0.081   12.389    0.000
##     c_8.9             1.100    0.091   12.048    0.000
##     c_9.10            1.412    0.132   10.707    0.000
##    .TPER7_01          0.328    0.035    9.235    0.000
##    .TPER7_04          0.568    0.046   12.251    0.000
##    .TPER7_15          0.372    0.035   10.475    0.000
##    .TPER7_19R         0.741    0.063   11.726    0.000
##    .TPER7_22R         0.806    0.067   11.967    0.000
##    .TPER8_01          0.332    0.031   10.658    0.000
##    .TPER8_04          0.652    0.046   14.206    0.000
##    .TPER8_15          0.363    0.031   11.584    0.000
##    .TPER8_19R         0.779    0.059   13.299    0.000
##    .TPER8_22R         0.852    0.063   13.497    0.000
##    .TPER9_01          0.386    0.034   11.298    0.000
##    .TPER9_04          0.713    0.049   14.512    0.000
##    .TPER9_15          0.383    0.033   11.646    0.000
##    .TPER9_19R         0.703    0.055   12.800    0.000
##    .TPER9_22R         0.722    0.056   12.889    0.000
##    .TPER10_01         0.348    0.039    8.929    0.000
##    .TPER10_04         0.616    0.053   11.551    0.000
##    .TPER10_15         0.463    0.045   10.225    0.000
##    .TPER10_19R        0.609    0.059   10.360    0.000
##    .TPER10_22R        0.640    0.062   10.397    0.000
##     E.change         -0.262    0.035   -7.462    0.000</code></pre>
<p>What does the negative variance here mean?</p>
</div>
<div id="steyer-models" class="section level2">
<h2>“steyer” models</h2>
<p>Similar to the above models but are addative in their interpretation. That is, the difference score between waves can be thought of adding or subtracting cumulatively from the previous wave. This is a closer hybrid between the growth model and the latent difference score model as the final difference score estimate is interpretted as across the entire time period.</p>
<pre class="r"><code>model &lt;-
&#39;extra7 =~ 1*TPER7_01 + cat6*TPER7_04 + cat2*TPER7_15 + cat3*TPER7_19R + cat4*TPER7_22R
extra8 =~ 1*TPER8_01 + cat6*TPER8_04 + cat2*TPER8_15 + cat3*TPER8_19R + cat4*TPER8_22R
extra9 =~ 1*TPER9_01 + cat6*TPER9_04 + cat2*TPER9_15 + cat3*TPER9_19R + cat4*TPER9_22R
extra10 =~ 1*TPER10_01 + cat6*TPER10_04 + cat2*TPER10_15 + cat3*TPER10_19R + cat4*TPER10_22R

TPER7_01 ~ 0*1
TPER7_04 ~ (nu1)*1
TPER7_15 ~ (nu2)*1
TPER7_19R ~ (nu3)*1
TPER7_22R ~ (nu4)*1

TPER8_01~ 0*1
TPER8_04 ~ (nu1)*1
TPER8_15~ (nu2)*1
TPER8_19R ~ (nu3)*1
TPER8_22R~ (nu4)*1

TPER9_01~ 0*1
TPER9_04 ~ (nu1)*1
TPER9_15~ (nu2)*1
TPER9_19R ~ (nu3)*1
TPER9_22R~ (nu4)*1

TPER10_01 ~ 0*1
TPER10_04 ~ (nu1)*1
TPER10_15 ~ (nu2)*1
TPER10_19R ~ (nu3)*1
TPER10_22R ~ (nu4)*1

TPER7_01 ~~ TPER8_01 + TPER9_01 + TPER10_01
TPER8_01 ~~ TPER9_01 + TPER10_01
TPER9_01 ~~ TPER10_01

TPER7_04 ~~ TPER8_04 + TPER9_04 + TPER10_04
TPER8_04 ~~ TPER9_04 + TPER10_04
TPER9_04 ~~ TPER10_04

TPER7_15 ~~ TPER8_15 + TPER9_15 + TPER10_15
TPER8_15 ~~ TPER9_15 + TPER10_15
TPER9_15 ~~ TPER10_15

TPER7_19R ~~ TPER8_19R + TPER9_19R + TPER10_19R
TPER8_19R ~~ TPER9_19R + TPER10_19R
TPER9_19R ~~ TPER10_19R

TPER7_22R ~~ TPER8_22R + TPER9_22R + TPER10_22R
TPER8_22R ~~ TPER9_22R + TPER10_22R
TPER9_22R ~~ TPER10_22R

extra7 ~ 0*1
extra8 ~ 0*1
extra9 ~ 0*1
extra10 ~ 0*1

extra7 ~~ 0*extra7
extra8 ~~ 0*extra8
extra9 ~~ 0*extra9
extra10 ~~ 0*extra10

t7 =~ 1*extra7 + 1*extra8 + 1*extra9 + 1*extra10
t7 ~ 1
t7 ~~ t7

d8 =~ 1*extra8
d8 ~~ d8
d8 ~ 1

d9 =~ 1*extra9
d9 ~~ d9
d9 ~ 1

d10 =~ 1*extra10
d10 ~~ d10
d10 ~ 1

t7 ~~ d8 + d9 + d10
d8 ~~ d9 + d10
d9 ~~ d10&#39;

fitE_t &lt;- sem(model, missing=&quot;ML&quot;, data = y_t_all)</code></pre>
<pre><code>## Warning in lav_data_full(data = data, group = group, cluster = cluster, : lavaan WARNING: some cases are empty and will be ignored:
##   14 24 32 33 34 36 37 39 48 49 51 57 76 78 80 83 84 86 90 91 98 109 119 129 130 131 140 144 145 157 165 167 170 171 177 180 182 183 190 206 222 227 229 234 247 250 260 287 292 295 301 302 307 327 339 342 345 349 354 356 359 360 369 370 377 383 384 386 393 406 411 414 419 421 422 425 426 429 440 442 446 448 449 450 456 460 462 470 473 476 485 491 494 496 503 504 507 508 516 532 535 539 546 547 548 552 554 555 556 559 561 563 566 571 584 586 587 591 596 599 601 607 620 630 634 635 642 645 650 651 658 666 673 678 687 716 718 732 735 737 738 740 745 751 761 766 776 785 786 788 790 795 796 802 804 823 827 831 842 847 851 853 860 887 892 901 920 923 926 927 936 938 940 947 949 952 953 955 956 957 969 972 977 979 981 985 993 999 1000 1003 1016 1029 1032 1035 1038 1040 1044 1046 1048 1050 1055 1059 1066</code></pre>
<pre><code>## Warning in lav_data_full(data = data, group = group, cluster = cluster, :
## lavaan WARNING: due to missing values, some pairwise combinations have less
## than 10% coverage</code></pre>
<pre class="r"><code>summary(fitE_t)</code></pre>
<pre><code>## lavaan 0.6-4 ended normally after 74 iterations
## 
##   Optimization method                           NLMINB
##   Number of free parameters                         96
##   Number of equality constraints                    24
##   Row rank of the constraints matrix                24
## 
##                                                   Used       Total
##   Number of observations                           864        1067
##   Number of missing patterns                        29
## 
##   Estimator                                         ML
##   Model Fit Test Statistic                     833.294
##   Degrees of freedom                               158
##   P-value (Chi-square)                           0.000
## 
## Parameter Estimates:
## 
##   Information                                 Observed
##   Observed information based on                Hessian
##   Standard Errors                             Standard
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   extra7 =~                                           
##     TPER7_0           1.000                           
##     TPER7_0 (cat6)    0.789    0.024   32.827    0.000
##     TPER7_1 (cat2)    0.987    0.022   44.223    0.000
##     TPER7_1 (cat3)    1.020    0.029   35.076    0.000
##     TPER7_2 (cat4)    1.022    0.030   34.287    0.000
##   extra8 =~                                           
##     TPER8_0           1.000                           
##     TPER8_0 (cat6)    0.789    0.024   32.827    0.000
##     TPER8_1 (cat2)    0.987    0.022   44.223    0.000
##     TPER8_1 (cat3)    1.020    0.029   35.076    0.000
##     TPER8_2 (cat4)    1.022    0.030   34.287    0.000
##   extra9 =~                                           
##     TPER9_0           1.000                           
##     TPER9_0 (cat6)    0.789    0.024   32.827    0.000
##     TPER9_1 (cat2)    0.987    0.022   44.223    0.000
##     TPER9_1 (cat3)    1.020    0.029   35.076    0.000
##     TPER9_2 (cat4)    1.022    0.030   34.287    0.000
##   extra10 =~                                          
##     TPER10_           1.000                           
##     TPER10_ (cat6)    0.789    0.024   32.827    0.000
##     TPER10_ (cat2)    0.987    0.022   44.223    0.000
##     TPER10_ (cat3)    1.020    0.029   35.076    0.000
##     TPER10_ (cat4)    1.022    0.030   34.287    0.000
##   t7 =~                                               
##     extra7            1.000                           
##     extra8            1.000                           
##     extra9            1.000                           
##     extra10           1.000                           
##   d8 =~                                               
##     extra8            1.000                           
##   d9 =~                                               
##     extra9            1.000                           
##   d10 =~                                              
##     extra10           1.000                           
## 
## Covariances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##  .TPER7_01 ~~                                         
##    .TPER8_01          0.049    0.030    1.634    0.102
##    .TPER9_01          0.087    0.035    2.457    0.014
##    .TPER10_01        -0.205    0.052   -3.937    0.000
##  .TPER8_01 ~~                                         
##    .TPER9_01          0.079    0.028    2.814    0.005
##    .TPER10_01         0.061    0.035    1.749    0.080
##  .TPER9_01 ~~                                         
##    .TPER10_01         0.021    0.034    0.616    0.538
##  .TPER7_04 ~~                                         
##    .TPER8_04          0.163    0.039    4.133    0.000
##    .TPER9_04          0.141    0.051    2.769    0.006
##    .TPER10_04         0.078    0.094    0.829    0.407
##  .TPER8_04 ~~                                         
##    .TPER9_04          0.225    0.043    5.289    0.000
##    .TPER10_04         0.086    0.053    1.604    0.109
##  .TPER9_04 ~~                                         
##    .TPER10_04         0.201    0.047    4.234    0.000
##  .TPER7_15 ~~                                         
##    .TPER8_15          0.022    0.030    0.725    0.468
##    .TPER9_15          0.008    0.034    0.241    0.810
##    .TPER10_15        -0.137    0.070   -1.958    0.050
##  .TPER8_15 ~~                                         
##    .TPER9_15          0.027    0.028    0.948    0.343
##    .TPER10_15         0.013    0.042    0.322    0.747
##  .TPER9_15 ~~                                         
##    .TPER10_15         0.008    0.033    0.240    0.810
##  .TPER7_19R ~~                                        
##    .TPER8_19R         0.104    0.055    1.890    0.059
##    .TPER9_19R        -0.074    0.060   -1.233    0.218
##    .TPER10_19R        0.189    0.092    2.059    0.039
##  .TPER8_19R ~~                                        
##    .TPER9_19R         0.110    0.053    2.078    0.038
##    .TPER10_19R        0.053    0.069    0.775    0.438
##  .TPER9_19R ~~                                        
##    .TPER10_19R       -0.036    0.052   -0.690    0.490
##  .TPER7_22R ~~                                        
##    .TPER8_22R         0.143    0.060    2.406    0.016
##    .TPER9_22R         0.019    0.061    0.304    0.761
##    .TPER10_22R        0.160    0.108    1.487    0.137
##  .TPER8_22R ~~                                        
##    .TPER9_22R         0.049    0.052    0.941    0.347
##    .TPER10_22R       -0.014    0.062   -0.227    0.820
##  .TPER9_22R ~~                                        
##    .TPER10_22R        0.025    0.054    0.467    0.640
##   t7 ~~                                               
##     d8               -0.532    0.073   -7.291    0.000
##     d9               -0.417    0.073   -5.693    0.000
##     d10              -0.501    0.118   -4.250    0.000
##   d8 ~~                                               
##     d9                0.495    0.090    5.533    0.000
##     d10               0.513    0.130    3.931    0.000
##   d9 ~~                                               
##     d10               0.420    0.121    3.472    0.001
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##    .TPER7_01          0.000                           
##    .TPER7_04 (nu1)    0.579    0.092    6.266    0.000
##    .TPER7_15 (nu2)   -0.059    0.086   -0.689    0.491
##    .TPER7_19 (nu3)   -0.461    0.111   -4.161    0.000
##    .TPER7_22 (nu4)   -0.581    0.114   -5.109    0.000
##    .TPER8_01          0.000                           
##    .TPER8_04 (nu1)    0.579    0.092    6.266    0.000
##    .TPER8_15 (nu2)   -0.059    0.086   -0.689    0.491
##    .TPER8_19 (nu3)   -0.461    0.111   -4.161    0.000
##    .TPER8_22 (nu4)   -0.581    0.114   -5.109    0.000
##    .TPER9_01          0.000                           
##    .TPER9_04 (nu1)    0.579    0.092    6.266    0.000
##    .TPER9_15 (nu2)   -0.059    0.086   -0.689    0.491
##    .TPER9_19 (nu3)   -0.461    0.111   -4.161    0.000
##    .TPER9_22 (nu4)   -0.581    0.114   -5.109    0.000
##    .TPER10_0          0.000                           
##    .TPER10_0 (nu1)    0.579    0.092    6.266    0.000
##    .TPER10_1 (nu2)   -0.059    0.086   -0.689    0.491
##    .TPER10_1 (nu3)   -0.461    0.111   -4.161    0.000
##    .TPER10_2 (nu4)   -0.581    0.114   -5.109    0.000
##    .extra7            0.000                           
##    .extra8            0.000                           
##    .extra9            0.000                           
##    .extra10           0.000                           
##     t7                3.681    0.051   72.878    0.000
##     d8               -0.015    0.056   -0.259    0.795
##     d9               -0.026    0.056   -0.466    0.641
##     d10               0.093    0.066    1.406    0.160
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##    .extra7            0.000                           
##    .extra8            0.000                           
##    .extra9            0.000                           
##    .extra10           0.000                           
##     t7                1.014    0.083   12.153    0.000
##     d8                1.067    0.108    9.831    0.000
##     d9                0.884    0.111    7.971    0.000
##     d10               0.931    0.203    4.589    0.000
##    .TPER7_01          0.321    0.035    9.069    0.000
##    .TPER7_04          0.566    0.046   12.253    0.000
##    .TPER7_15          0.368    0.035   10.408    0.000
##    .TPER7_19R         0.733    0.063   11.624    0.000
##    .TPER7_22R         0.800    0.067   11.858    0.000
##    .TPER8_01          0.325    0.031   10.530    0.000
##    .TPER8_04          0.650    0.046   14.201    0.000
##    .TPER8_15          0.366    0.031   11.624    0.000
##    .TPER8_19R         0.786    0.059   13.328    0.000
##    .TPER8_22R         0.850    0.063   13.482    0.000
##    .TPER9_01          0.388    0.034   11.345    0.000
##    .TPER9_04          0.713    0.049   14.525    0.000
##    .TPER9_15          0.380    0.033   11.634    0.000
##    .TPER9_19R         0.706    0.055   12.837    0.000
##    .TPER9_22R         0.724    0.056   12.918    0.000
##    .TPER10_01         0.348    0.039    8.953    0.000
##    .TPER10_04         0.615    0.053   11.579    0.000
##    .TPER10_15         0.465    0.045   10.239    0.000
##    .TPER10_19R        0.613    0.059   10.412    0.000
##    .TPER10_22R        0.642    0.062   10.427    0.000</code></pre>
<p>Compare the means here with the means of the original latent difference score model.</p>
</div>
<div id="adding-time-varying-covariates" class="section level2">
<h2>adding time varying covariates</h2>
<p>The tricky tricky part is interpretation. It is also possible to constraint the effect of the TVC to be the same across time.</p>
<pre class="r"><code>tvc.mw.model &lt;-
&#39;e7 =~ 1*TPER7_01 + cat6*TPER7_04 + cat2*TPER7_15 + cat3*TPER7_19R + cat4*TPER7_22R
e8 =~ 1*TPER8_01 + cat6*TPER8_04 + cat2*TPER8_15 + cat3*TPER8_19R + cat4*TPER8_22R
e9 =~ 1*TPER9_01 + cat6*TPER9_04 + cat2*TPER9_15 + cat3*TPER9_19R + cat4*TPER9_22R
e10 =~ 1*TPER10_01 + cat6*TPER10_04 + cat2*TPER10_15 + cat3*TPER10_19R + cat4*TPER10_22R


# settting the fixed regressions to 1

e8 ~ 1*e7     
e9 ~ 1*e8  
e10 ~ 1*e9  

# creating the change scores 

c_7.8 =~ 1*e8     
c_8.9 =~ 1*e9 
c_9.10 =~ 1*e10 


# constraint intercepts
e8 ~ 0*1        
e9 ~ 0*1   
e10 ~ 0*1   

# This fixes the variance to 0

e8 ~~ 0*e8     
e9 ~~ 0*e9  
e10 ~~ 0*e10  

# Estimate the intercept of the change score
c_7.8 ~ 1    
c_8.9 ~ 1 
c_9.10 ~ 1             

# This estimates the intercept and variance of initial time
e7 ~  1           
e7 ~~  e7 

#  Estimates the variance of the change scores
c_7.8 ~~ c_7.8    
c_8.9 ~~ c_8.9 
c_9.10 ~~ c_9.10       


# Estimates the covaration with change scores and T1
e7  ~~ c_7.8 + c_8.9 + c_9.10 
c_7.8 ~~ c_8.9 + c_9.10
c_8.9 ~~ c_9.10

## Allow indicators to covary
TPER7_01 ~~ TPER8_01 + TPER9_01 + TPER10_01
TPER8_01 ~~ TPER9_01 + TPER10_01
TPER9_01 ~~ TPER10_01

TPER7_04 ~~ TPER8_04 + TPER9_04 + TPER10_04
TPER8_04 ~~ TPER9_04 + TPER10_04
TPER9_04 ~~ TPER10_04

TPER7_15 ~~ TPER8_15 + TPER9_15 + TPER10_15
TPER8_15 ~~ TPER9_15 + TPER10_15
TPER9_15 ~~ TPER10_15

TPER7_19R ~~ TPER8_19R + TPER9_19R + TPER10_19R
TPER8_19R ~~ TPER9_19R + TPER10_19R
TPER9_19R ~~ TPER10_19R

TPER7_22R ~~ TPER8_22R + TPER9_22R + TPER10_22R
TPER8_22R ~~ TPER9_22R + TPER10_22R
TPER9_22R ~~ TPER10_22R



#scales the items and add measurement invariance

TPER7_01 ~ 0*1
TPER7_04 ~ (nu1)*1
TPER7_15 ~ (nu2)*1
TPER7_19R ~ (nu3)*1
TPER7_22R ~ (nu4)*1

TPER8_01~ 0*1
TPER8_04 ~ (nu1)*1
TPER8_15~ (nu2)*1
TPER8_19R ~ (nu3)*1
TPER8_22R~ (nu4)*1

TPER9_01~ 0*1
TPER9_04 ~ (nu1)*1
TPER9_15~ (nu2)*1
TPER9_19R ~ (nu3)*1
TPER9_22R~ (nu4)*1

TPER10_01 ~ 0*1
TPER10_04 ~ (nu1)*1
TPER10_15 ~ (nu2)*1
TPER10_19R ~ (nu3)*1
TPER10_22R ~ (nu4)*1

# predicting change
# Note: Technically the covariate model above is set up the same way.  

c_7.8 ~  ALC8_01   
c_8.9 ~  ALC9_01
c_9.10 ~ ALC10_01


&#39;

tvc.mw.model &lt;- sem(tvc.mw.model, data=y_t_all , missing=&quot;ML&quot;)</code></pre>
<pre><code>## Warning in lav_data_full(data = data, group = group, cluster = cluster, : lavaan WARNING: 250 cases were deleted due to missing values in 
##        exogenous variable(s), while fixed.x = TRUE.</code></pre>
<pre><code>## Warning in lav_data_full(data = data, group = group, cluster = cluster, :
## lavaan WARNING: due to missing values, some pairwise combinations have less
## than 10% coverage</code></pre>
<pre class="r"><code>summary(tvc.mw.model, fit.measures=TRUE, standardized=TRUE)</code></pre>
<pre><code>## lavaan 0.6-4 ended normally after 80 iterations
## 
##   Optimization method                           NLMINB
##   Number of free parameters                         99
##   Number of equality constraints                    24
##   Row rank of the constraints matrix                24
## 
##                                                   Used       Total
##   Number of observations                           817        1067
##   Number of missing patterns                        30
## 
##   Estimator                                         ML
##   Model Fit Test Statistic                     884.163
##   Degrees of freedom                               215
##   P-value (Chi-square)                           0.000
## 
## Model test baseline model:
## 
##   Minimum Function Test Statistic             5667.448
##   Degrees of freedom                               250
##   P-value                                        0.000
## 
## User model versus baseline model:
## 
##   Comparative Fit Index (CFI)                    0.876
##   Tucker-Lewis Index (TLI)                       0.856
## 
## Loglikelihood and Information Criteria:
## 
##   Loglikelihood user model (H0)             -10485.293
##   Loglikelihood unrestricted model (H1)     -10043.212
## 
##   Number of free parameters                         75
##   Akaike (AIC)                               21120.586
##   Bayesian (BIC)                             21473.509
##   Sample-size adjusted Bayesian (BIC)        21235.338
## 
## Root Mean Square Error of Approximation:
## 
##   RMSEA                                          0.062
##   90 Percent Confidence Interval          0.058  0.066
##   P-value RMSEA &lt;= 0.05                          0.000
## 
## Standardized Root Mean Square Residual:
## 
##   SRMR                                           0.065
## 
## Parameter Estimates:
## 
##   Information                                 Observed
##   Observed information based on                Hessian
##   Standard Errors                             Standard
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   e7 =~                                                                 
##     TPER7_0           1.000                               1.012    0.872
##     TPER7_0 (cat6)    0.794    0.025   31.293    0.000    0.804    0.730
##     TPER7_1 (cat2)    1.003    0.024   41.765    0.000    1.015    0.860
##     TPER7_1 (cat3)    1.025    0.031   32.905    0.000    1.038    0.769
##     TPER7_2 (cat4)    1.029    0.032   32.169    0.000    1.042    0.758
##   e8 =~                                                                 
##     TPER8_0           1.000                               0.977    0.868
##     TPER8_0 (cat6)    0.794    0.025   31.293    0.000    0.776    0.697
##     TPER8_1 (cat2)    1.003    0.024   41.765    0.000    0.980    0.851
##     TPER8_1 (cat3)    1.025    0.031   32.905    0.000    1.002    0.744
##     TPER8_2 (cat4)    1.029    0.032   32.169    0.000    1.006    0.733
##   e9 =~                                                                 
##     TPER9_0           1.000                               1.027    0.855
##     TPER9_0 (cat6)    0.794    0.025   31.293    0.000    0.816    0.721
##     TPER9_1 (cat2)    1.003    0.024   41.765    0.000    1.030    0.857
##     TPER9_1 (cat3)    1.025    0.031   32.905    0.000    1.053    0.778
##     TPER9_2 (cat4)    1.029    0.032   32.169    0.000    1.057    0.779
##   e10 =~                                                                
##     TPER10_           1.000                               0.952    0.850
##     TPER10_ (cat6)    0.794    0.025   31.293    0.000    0.756    0.680
##     TPER10_ (cat2)    1.003    0.024   41.765    0.000    0.954    0.822
##     TPER10_ (cat3)    1.025    0.031   32.905    0.000    0.976    0.779
##     TPER10_ (cat4)    1.029    0.032   32.169    0.000    0.980    0.775
##   c_7.8 =~                                                              
##     e8                1.000                               1.044    1.044
##   c_8.9 =~                                                              
##     e9                1.000                               0.954    0.954
##   c_9.10 =~                                                             
##     e10               1.000                               1.033    1.033
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   e8 ~                                                                  
##     e7                1.000                               1.036    1.036
##   e9 ~                                                                  
##     e8                1.000                               0.951    0.951
##   e10 ~                                                                 
##     e9                1.000                               1.079    1.079
##   c_7.8 ~                                                               
##     ALC8_01          -0.114    0.082   -1.395    0.163   -0.112   -0.051
##   c_8.9 ~                                                               
##     ALC9_01          -0.113    0.101   -1.122    0.262   -0.116   -0.049
##   c_9.10 ~                                                              
##     ALC10_01         -0.130    0.131   -0.995    0.320   -0.133   -0.053
## 
## Covariances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   e7 ~~                                                                 
##    .c_7.8            -0.555    0.076   -7.293    0.000   -0.538   -0.538
##    .c_8.9             0.122    0.075    1.614    0.107    0.123    0.123
##    .c_9.10           -0.093    0.118   -0.791    0.429   -0.094   -0.094
##  .c_7.8 ~~                                                              
##    .c_8.9            -0.553    0.087   -6.330    0.000   -0.555   -0.555
##    .c_9.10            0.022    0.131    0.168    0.866    0.022    0.022
##  .c_8.9 ~~                                                              
##    .c_9.10           -0.490    0.088   -5.539    0.000   -0.510   -0.510
##  .TPER7_01 ~~                                                           
##    .TPER8_01          0.048    0.030    1.589    0.112    0.048    0.153
##    .TPER9_01          0.078    0.036    2.149    0.032    0.078    0.220
##    .TPER10_01        -0.208    0.053   -3.911    0.000   -0.208   -0.622
##  .TPER8_01 ~~                                                           
##    .TPER9_01          0.066    0.028    2.355    0.019    0.066    0.190
##    .TPER10_01         0.067    0.034    1.941    0.052    0.067    0.202
##  .TPER9_01 ~~                                                           
##    .TPER10_01         0.025    0.035    0.699    0.485    0.025    0.067
##  .TPER7_04 ~~                                                           
##    .TPER8_04          0.168    0.041    4.098    0.000    0.168    0.280
##    .TPER9_04          0.123    0.048    2.588    0.010    0.123    0.209
##    .TPER10_04         0.123    0.100    1.229    0.219    0.123    0.201
##  .TPER8_04 ~~                                                           
##    .TPER9_04          0.201    0.040    5.037    0.000    0.201    0.320
##    .TPER10_04         0.096    0.056    1.707    0.088    0.096    0.148
##  .TPER9_04 ~~                                                           
##    .TPER10_04         0.219    0.048    4.600    0.000    0.219    0.343
##  .TPER7_15 ~~                                                           
##    .TPER8_15          0.028    0.031    0.889    0.374    0.028    0.076
##    .TPER9_15          0.000    0.035    0.010    0.992    0.000    0.001
##    .TPER10_15        -0.093    0.079   -1.171    0.242   -0.093   -0.233
##  .TPER8_15 ~~                                                           
##    .TPER9_15          0.017    0.029    0.578    0.563    0.017    0.045
##    .TPER10_15         0.019    0.041    0.452    0.651    0.019    0.046
##  .TPER9_15 ~~                                                           
##    .TPER10_15         0.042    0.035    1.195    0.232    0.042    0.103
##  .TPER7_19R ~~                                                          
##    .TPER8_19R         0.119    0.058    2.045    0.041    0.119    0.153
##    .TPER9_19R        -0.076    0.063   -1.203    0.229   -0.076   -0.104
##    .TPER10_19R        0.171    0.095    1.791    0.073    0.171    0.252
##  .TPER8_19R ~~                                                          
##    .TPER9_19R         0.123    0.055    2.223    0.026    0.123    0.161
##    .TPER10_19R        0.050    0.071    0.715    0.475    0.050    0.071
##  .TPER9_19R ~~                                                          
##    .TPER10_19R       -0.066    0.057   -1.155    0.248   -0.066   -0.098
##  .TPER7_22R ~~                                                          
##    .TPER8_22R         0.149    0.062    2.381    0.017    0.149    0.177
##    .TPER9_22R         0.024    0.061    0.399    0.690    0.024    0.032
##    .TPER10_22R        0.140    0.110    1.275    0.202    0.140    0.195
##  .TPER8_22R ~~                                                          
##    .TPER9_22R         0.063    0.053    1.184    0.237    0.063    0.080
##    .TPER10_22R       -0.016    0.063   -0.253    0.800   -0.016   -0.021
##  .TPER9_22R ~~                                                          
##    .TPER10_22R        0.034    0.058    0.590    0.555    0.034    0.050
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .e8                0.000                               0.000    0.000
##    .e9                0.000                               0.000    0.000
##    .e10               0.000                               0.000    0.000
##    .c_7.8             0.160    0.118    1.350    0.177    0.157    0.157
##    .c_8.9             0.117    0.138    0.849    0.396    0.120    0.120
##    .c_9.10            0.266    0.172    1.543    0.123    0.271    0.271
##     e7                3.703    0.053   69.590    0.000    3.658    3.658
##    .TPER7_01          0.000                               0.000    0.000
##    .TPER7_04 (nu1)    0.593    0.098    6.036    0.000    0.593    0.539
##    .TPER7_15 (nu2)   -0.126    0.093   -1.362    0.173   -0.126   -0.107
##    .TPER7_19 (nu3)   -0.485    0.120   -4.060    0.000   -0.485   -0.360
##    .TPER7_22 (nu4)   -0.603    0.123   -4.917    0.000   -0.603   -0.439
##    .TPER8_01          0.000                               0.000    0.000
##    .TPER8_04 (nu1)    0.593    0.098    6.036    0.000    0.593    0.532
##    .TPER8_15 (nu2)   -0.126    0.093   -1.362    0.173   -0.126   -0.110
##    .TPER8_19 (nu3)   -0.485    0.120   -4.060    0.000   -0.485   -0.361
##    .TPER8_22 (nu4)   -0.603    0.123   -4.917    0.000   -0.603   -0.439
##    .TPER9_01          0.000                               0.000    0.000
##    .TPER9_04 (nu1)    0.593    0.098    6.036    0.000    0.593    0.524
##    .TPER9_15 (nu2)   -0.126    0.093   -1.362    0.173   -0.126   -0.105
##    .TPER9_19 (nu3)   -0.485    0.120   -4.060    0.000   -0.485   -0.359
##    .TPER9_22 (nu4)   -0.603    0.123   -4.917    0.000   -0.603   -0.445
##    .TPER10_0          0.000                               0.000    0.000
##    .TPER10_0 (nu1)    0.593    0.098    6.036    0.000    0.593    0.533
##    .TPER10_1 (nu2)   -0.126    0.093   -1.362    0.173   -0.126   -0.109
##    .TPER10_1 (nu3)   -0.485    0.120   -4.060    0.000   -0.485   -0.387
##    .TPER10_2 (nu4)   -0.603    0.123   -4.917    0.000   -0.603   -0.477
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .e8                0.000                               0.000    0.000
##    .e9                0.000                               0.000    0.000
##    .e10               0.000                               0.000    0.000
##     e7                1.025    0.089   11.575    0.000    1.000    1.000
##    .c_7.8             1.038    0.110    9.443    0.000    0.997    0.997
##    .c_8.9             0.958    0.101    9.506    0.000    0.998    0.998
##    .c_9.10            0.964    0.108    8.946    0.000    0.997    0.997
##    .TPER7_01          0.322    0.038    8.547    0.000    0.322    0.239
##    .TPER7_04          0.565    0.049   11.563    0.000    0.565    0.466
##    .TPER7_15          0.364    0.037    9.799    0.000    0.364    0.261
##    .TPER7_19R         0.743    0.067   11.029    0.000    0.743    0.408
##    .TPER7_22R         0.806    0.072   11.252    0.000    0.806    0.426
##    .TPER8_01          0.313    0.031   10.128    0.000    0.313    0.247
##    .TPER8_04          0.639    0.047   13.714    0.000    0.639    0.515
##    .TPER8_15          0.367    0.033   11.197    0.000    0.367    0.276
##    .TPER8_19R         0.807    0.062   12.973    0.000    0.807    0.446
##    .TPER8_22R         0.873    0.067   13.103    0.000    0.873    0.463
##    .TPER9_01          0.389    0.036   10.749    0.000    0.389    0.269
##    .TPER9_04          0.615    0.046   13.322    0.000    0.615    0.480
##    .TPER9_15          0.382    0.035   10.897    0.000    0.382    0.265
##    .TPER9_19R         0.721    0.059   12.121    0.000    0.721    0.394
##    .TPER9_22R         0.723    0.060   12.140    0.000    0.723    0.393
##    .TPER10_01         0.348    0.041    8.406    0.000    0.348    0.278
##    .TPER10_04         0.664    0.061   10.949    0.000    0.664    0.538
##    .TPER10_15         0.438    0.047    9.358    0.000    0.438    0.325
##    .TPER10_19R        0.618    0.063    9.746    0.000    0.618    0.394
##    .TPER10_22R        0.639    0.066    9.736    0.000    0.639    0.400</code></pre>
<pre class="r"><code>y_t_all$alc</code></pre>
<pre><code>## NULL</code></pre>
</div>
</div>
<div id="latent-duel-change-score-model-like-a-residualized-latent-change-score" class="section level1">
<h1>Latent Duel change score model (like a residualized latent change score)</h1>
<p>The regression from t-1 to change at t can also be introduced into these models. It will have a new name: self-feedback. It is akin to our standard intercept-change correlation where it may be those who start higher change more (or less). This parameter will become important when we start to examine bivariate models. It is called duel because there are two components: the rate of change (slope) and the self-feedback.</p>
<pre class="r"><code>duel.model &lt;-
&#39;e7 =~ 1*TPER7_01 + cat6*TPER7_04 + cat2*TPER7_15 + cat3*TPER7_19R + cat4*TPER7_22R
e8 =~ 1*TPER8_01 + cat6*TPER8_04 + cat2*TPER8_15 + cat3*TPER8_19R + cat4*TPER8_22R
e9 =~ 1*TPER9_01 + cat6*TPER9_04 + cat2*TPER9_15 + cat3*TPER9_19R + cat4*TPER9_22R
e10 =~ 1*TPER10_01 + cat6*TPER10_04 + cat2*TPER10_15 + cat3*TPER10_19R + cat4*TPER10_22R


# settting the fixed regressions to 1

e8 ~ 1*e7     
e9 ~ 1*e8  
e10 ~ 1*e9  

# creating the change scores 

c_7.8 =~ 1*e8     
c_8.9 =~ 1*e9 
c_9.10 =~ 1*e10 


# constraint intercepts
e8 ~ 0*1        
e9 ~ 0*1   
e10 ~ 0*1   

# This fixes the variance to 0

e8 ~~ 0*e8     
e9 ~~ 0*e9  
e10 ~~ 0*e10  

# Estimate the intercept of the change score
c_7.8 ~ 1    
c_8.9 ~ 1 
c_9.10 ~ 1             

# This estimates the intercept and variance of initial time
e7 ~  1           
e7 ~~  e7 

#  Estimates the variance of the change scores
c_7.8 ~~ c_7.8    
c_8.9 ~~ c_8.9 
c_9.10 ~~ c_9.10       

## This is the novel component of the DUEL Latent Difference Scores
# Instead of estimating the covariance, we are going to regress change onto the previous timepoint. 
c_7.8 ~ e7 
c_8.9 ~ e8
c_9.10 ~ e9

## Allow indicators to covary
TPER7_01 ~~ TPER8_01 + TPER9_01 + TPER10_01
TPER8_01 ~~ TPER9_01 + TPER10_01
TPER9_01 ~~ TPER10_01

TPER7_04 ~~ TPER8_04 + TPER9_04 + TPER10_04
TPER8_04 ~~ TPER9_04 + TPER10_04
TPER9_04 ~~ TPER10_04

TPER7_15 ~~ TPER8_15 + TPER9_15 + TPER10_15
TPER8_15 ~~ TPER9_15 + TPER10_15
TPER9_15 ~~ TPER10_15

TPER7_19R ~~ TPER8_19R + TPER9_19R + TPER10_19R
TPER8_19R ~~ TPER9_19R + TPER10_19R
TPER9_19R ~~ TPER10_19R

TPER7_22R ~~ TPER8_22R + TPER9_22R + TPER10_22R
TPER8_22R ~~ TPER9_22R + TPER10_22R
TPER9_22R ~~ TPER10_22R



#scales the items and add measurement invariance

TPER7_01 ~ 0*1
TPER7_04 ~ (nu1)*1
TPER7_15 ~ (nu2)*1
TPER7_19R ~ (nu3)*1
TPER7_22R ~ (nu4)*1

TPER8_01~ 0*1
TPER8_04 ~ (nu1)*1
TPER8_15~ (nu2)*1
TPER8_19R ~ (nu3)*1
TPER8_22R~ (nu4)*1

TPER9_01~ 0*1
TPER9_04 ~ (nu1)*1
TPER9_15~ (nu2)*1
TPER9_19R ~ (nu3)*1
TPER9_22R~ (nu4)*1

TPER10_01 ~ 0*1
TPER10_04 ~ (nu1)*1
TPER10_15 ~ (nu2)*1
TPER10_19R ~ (nu3)*1
TPER10_22R ~ (nu4)*1

&#39;

duel.model &lt;- sem(duel.model, data=y_t_all , missing=&quot;ML&quot;)</code></pre>
<pre><code>## Warning in lav_data_full(data = data, group = group, cluster = cluster, : lavaan WARNING: some cases are empty and will be ignored:
##   14 24 32 33 34 36 37 39 48 49 51 57 76 78 80 83 84 86 90 91 98 109 119 129 130 131 140 144 145 157 165 167 170 171 177 180 182 183 190 206 222 227 229 234 247 250 260 287 292 295 301 302 307 327 339 342 345 349 354 356 359 360 369 370 377 383 384 386 393 406 411 414 419 421 422 425 426 429 440 442 446 448 449 450 456 460 462 470 473 476 485 491 494 496 503 504 507 508 516 532 535 539 546 547 548 552 554 555 556 559 561 563 566 571 584 586 587 591 596 599 601 607 620 630 634 635 642 645 650 651 658 666 673 678 687 716 718 732 735 737 738 740 745 751 761 766 776 785 786 788 790 795 796 802 804 823 827 831 842 847 851 853 860 887 892 901 920 923 926 927 936 938 940 947 949 952 953 955 956 957 969 972 977 979 981 985 993 999 1000 1003 1016 1029 1032 1035 1038 1040 1044 1046 1048 1050 1055 1059 1066</code></pre>
<pre><code>## Warning in lav_data_full(data = data, group = group, cluster = cluster, :
## lavaan WARNING: due to missing values, some pairwise combinations have less
## than 10% coverage</code></pre>
<pre class="r"><code>summary(duel.model, fit.measures=TRUE)</code></pre>
<pre><code>## lavaan 0.6-4 ended normally after 87 iterations
## 
##   Optimization method                           NLMINB
##   Number of free parameters                         96
##   Number of equality constraints                    24
##   Row rank of the constraints matrix                24
## 
##                                                   Used       Total
##   Number of observations                           864        1067
##   Number of missing patterns                        29
## 
##   Estimator                                         ML
##   Model Fit Test Statistic                     833.294
##   Degrees of freedom                               158
##   P-value (Chi-square)                           0.000
## 
## Model test baseline model:
## 
##   Minimum Function Test Statistic             6120.154
##   Degrees of freedom                               190
##   P-value                                        0.000
## 
## User model versus baseline model:
## 
##   Comparative Fit Index (CFI)                    0.886
##   Tucker-Lewis Index (TLI)                       0.863
## 
## Loglikelihood and Information Criteria:
## 
##   Loglikelihood user model (H0)             -11678.547
##   Loglikelihood unrestricted model (H1)     -11261.900
## 
##   Number of free parameters                         72
##   Akaike (AIC)                               23501.094
##   Bayesian (BIC)                             23843.927
##   Sample-size adjusted Bayesian (BIC)        23615.274
## 
## Root Mean Square Error of Approximation:
## 
##   RMSEA                                          0.070
##   90 Percent Confidence Interval          0.066  0.075
##   P-value RMSEA &lt;= 0.05                          0.000
## 
## Standardized Root Mean Square Residual:
## 
##   SRMR                                           0.064
## 
## Parameter Estimates:
## 
##   Information                                 Observed
##   Observed information based on                Hessian
##   Standard Errors                             Standard
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   e7 =~                                               
##     TPER7_0           1.000                           
##     TPER7_0 (cat6)    0.789    0.024   32.827    0.000
##     TPER7_1 (cat2)    0.987    0.022   44.223    0.000
##     TPER7_1 (cat3)    1.020    0.029   35.076    0.000
##     TPER7_2 (cat4)    1.022    0.030   34.288    0.000
##   e8 =~                                               
##     TPER8_0           1.000                           
##     TPER8_0 (cat6)    0.789    0.024   32.827    0.000
##     TPER8_1 (cat2)    0.987    0.022   44.223    0.000
##     TPER8_1 (cat3)    1.020    0.029   35.076    0.000
##     TPER8_2 (cat4)    1.022    0.030   34.288    0.000
##   e9 =~                                               
##     TPER9_0           1.000                           
##     TPER9_0 (cat6)    0.789    0.024   32.827    0.000
##     TPER9_1 (cat2)    0.987    0.022   44.223    0.000
##     TPER9_1 (cat3)    1.020    0.029   35.076    0.000
##     TPER9_2 (cat4)    1.022    0.030   34.288    0.000
##   e10 =~                                              
##     TPER10_           1.000                           
##     TPER10_ (cat6)    0.789    0.024   32.827    0.000
##     TPER10_ (cat2)    0.987    0.022   44.223    0.000
##     TPER10_ (cat3)    1.020    0.029   35.076    0.000
##     TPER10_ (cat4)    1.022    0.030   34.288    0.000
##   c_7.8 =~                                            
##     e8                1.000                           
##   c_8.9 =~                                            
##     e9                1.000                           
##   c_9.10 =~                                           
##     e10               1.000                           
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   e8 ~                                                
##     e7                1.000                           
##   e9 ~                                                
##     e8                1.000                           
##   e10 ~                                               
##     e9                1.000                           
##   c_7.8 ~                                             
##     e7               -0.524    0.054   -9.628    0.000
##   c_8.9 ~                                             
##     e8                0.238    0.168    1.414    0.157
##   c_9.10 ~                                            
##     e9               -0.142    0.189   -0.752    0.452
## 
## Covariances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##  .TPER7_01 ~~                                         
##    .TPER8_01          0.049    0.030    1.634    0.102
##    .TPER9_01          0.087    0.035    2.457    0.014
##    .TPER10_01        -0.205    0.052   -3.936    0.000
##  .TPER8_01 ~~                                         
##    .TPER9_01          0.079    0.028    2.814    0.005
##    .TPER10_01         0.061    0.035    1.749    0.080
##  .TPER9_01 ~~                                         
##    .TPER10_01         0.021    0.034    0.616    0.538
##  .TPER7_04 ~~                                         
##    .TPER8_04          0.163    0.039    4.133    0.000
##    .TPER9_04          0.141    0.051    2.770    0.006
##    .TPER10_04         0.078    0.094    0.829    0.407
##  .TPER8_04 ~~                                         
##    .TPER9_04          0.225    0.043    5.289    0.000
##    .TPER10_04         0.086    0.053    1.605    0.109
##  .TPER9_04 ~~                                         
##    .TPER10_04         0.201    0.047    4.234    0.000
##  .TPER7_15 ~~                                         
##    .TPER8_15          0.022    0.030    0.725    0.468
##    .TPER9_15          0.008    0.034    0.241    0.810
##    .TPER10_15        -0.137    0.070   -1.958    0.050
##  .TPER8_15 ~~                                         
##    .TPER9_15          0.027    0.028    0.948    0.343
##    .TPER10_15         0.013    0.042    0.322    0.747
##  .TPER9_15 ~~                                         
##    .TPER10_15         0.008    0.033    0.240    0.810
##  .TPER7_19R ~~                                        
##    .TPER8_19R         0.104    0.055    1.890    0.059
##    .TPER9_19R        -0.074    0.060   -1.232    0.218
##    .TPER10_19R        0.189    0.092    2.059    0.039
##  .TPER8_19R ~~                                        
##    .TPER9_19R         0.110    0.053    2.078    0.038
##    .TPER10_19R        0.053    0.069    0.775    0.438
##  .TPER9_19R ~~                                        
##    .TPER10_19R       -0.036    0.052   -0.690    0.490
##  .TPER7_22R ~~                                        
##    .TPER8_22R         0.143    0.060    2.406    0.016
##    .TPER9_22R         0.019    0.061    0.304    0.761
##    .TPER10_22R        0.160    0.108    1.487    0.137
##  .TPER8_22R ~~                                        
##    .TPER9_22R         0.049    0.052    0.941    0.347
##    .TPER10_22R       -0.014    0.062   -0.227    0.820
##  .TPER9_22R ~~                                        
##    .TPER10_22R        0.025    0.054    0.467    0.640
##  .c_7.8 ~~                                            
##    .c_8.9            -0.699    0.169   -4.141    0.000
##    .c_9.10            0.012    0.123    0.100    0.920
##  .c_8.9 ~~                                            
##    .c_9.10           -0.413    0.117   -3.520    0.000
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##    .e8                0.000                           
##    .e9                0.000                           
##    .e10               0.000                           
##    .c_7.8             1.914    0.206    9.291    0.000
##    .c_8.9            -0.885    0.622   -1.423    0.155
##    .c_9.10            0.638    0.698    0.913    0.361
##     e7                3.681    0.051   72.878    0.000
##    .TPER7_01          0.000                           
##    .TPER7_04 (nu1)    0.579    0.092    6.266    0.000
##    .TPER7_15 (nu2)   -0.059    0.086   -0.689    0.491
##    .TPER7_19 (nu3)   -0.461    0.111   -4.161    0.000
##    .TPER7_22 (nu4)   -0.581    0.114   -5.109    0.000
##    .TPER8_01          0.000                           
##    .TPER8_04 (nu1)    0.579    0.092    6.266    0.000
##    .TPER8_15 (nu2)   -0.059    0.086   -0.689    0.491
##    .TPER8_19 (nu3)   -0.461    0.111   -4.161    0.000
##    .TPER8_22 (nu4)   -0.581    0.114   -5.109    0.000
##    .TPER9_01          0.000                           
##    .TPER9_04 (nu1)    0.579    0.092    6.266    0.000
##    .TPER9_15 (nu2)   -0.059    0.086   -0.689    0.491
##    .TPER9_19 (nu3)   -0.461    0.111   -4.161    0.000
##    .TPER9_22 (nu4)   -0.581    0.114   -5.109    0.000
##    .TPER10_0          0.000                           
##    .TPER10_0 (nu1)    0.579    0.092    6.266    0.000
##    .TPER10_1 (nu2)   -0.059    0.086   -0.689    0.491
##    .TPER10_1 (nu3)   -0.461    0.111   -4.161    0.000
##    .TPER10_2 (nu4)   -0.581    0.114   -5.109    0.000
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##    .e8                0.000                           
##    .e9                0.000                           
##    .e10               0.000                           
##     e7                1.014    0.083   12.153    0.000
##    .c_7.8             0.788    0.071   11.163    0.000
##    .c_8.9             1.235    0.265    4.664    0.000
##    .c_9.10            0.841    0.175    4.818    0.000
##    .TPER7_01          0.321    0.035    9.069    0.000
##    .TPER7_04          0.566    0.046   12.253    0.000
##    .TPER7_15          0.368    0.035   10.408    0.000
##    .TPER7_19R         0.733    0.063   11.624    0.000
##    .TPER7_22R         0.800    0.067   11.858    0.000
##    .TPER8_01          0.325    0.031   10.530    0.000
##    .TPER8_04          0.650    0.046   14.201    0.000
##    .TPER8_15          0.366    0.031   11.624    0.000
##    .TPER8_19R         0.786    0.059   13.328    0.000
##    .TPER8_22R         0.850    0.063   13.482    0.000
##    .TPER9_01          0.388    0.034   11.345    0.000
##    .TPER9_04          0.713    0.049   14.525    0.000
##    .TPER9_15          0.380    0.033   11.634    0.000
##    .TPER9_19R         0.706    0.055   12.837    0.000
##    .TPER9_22R         0.724    0.056   12.918    0.000
##    .TPER10_01         0.348    0.039    8.953    0.000
##    .TPER10_04         0.615    0.053   11.579    0.000
##    .TPER10_15         0.465    0.045   10.239    0.000
##    .TPER10_19R        0.613    0.059   10.412    0.000
##    .TPER10_22R        0.642    0.062   10.427    0.000</code></pre>
<p>Notice the large changes within this model in terms of mean level change. This suggests that a lot of the change was due to intercept differences or that there is regression towards the mean.</p>
<p>One could attempt to constrain each of the self-feedback parameters to be the same to see if this fit the model better or worse.</p>
</div>
<div id="bivariate-multi-wave-latent-change-model" class="section level1">
<h1>Bivariate multi wave latent change model</h1>
<p>The real benefit of this type of framework is building on this type of change model to incorporate multiple change models simultanously. This allows one to look at multiple change processes in a single model, opening the door to analyzing more dynamic processes.</p>
<p>One of the main parameters of interest is what is called a coupling parameter. Coupling parameter is like a self-feedback, but instead of feeding into change in the same variable, it is feeding into change in a different variable (not unlike the idea of cross-lags).</p>
<pre class="r"><code>BDCS&lt;-&#39;

COGlv_T1=~1*COG_T1        # Defining the COG latent variables
COGlv_T2=~1*COG_T2        # Defining the COG latent variables
COGlv_T3=~1*COG_T3        # Defining the COG latent variables
COGlv_T4=~1*COG_T4        # Defining the COG latent variables

NEUlv_T1=~1*NEU_T1        # Defining the NEU latent variables
NEUlv_T2=~1*NEU_T2        # Defining the NEU latent variables
NEUlv_T3=~1*NEU_T3        # Defining the NEU latent variables
NEUlv_T4=~1*NEU_T4        # Defining the NEU latent variables


COGlv_T2 ~ 1*COGlv_T1     # This parameter regresses COG_T2 perfectly on COG_T1
COGlv_T3 ~ 1*COGlv_T2     # This parameter regresses COG_T3 perfectly on COG_T2
COGlv_T4 ~ 1*COGlv_T3     # This parameter regresses COG_T4 perfectly on COG_T3

NEUlv_T2 ~ 1*NEUlv_T1     # This parameter regresses NEU_T2 perfectly on NEU_T1
NEUlv_T3 ~ 1*NEUlv_T2     # This parameter regresses NEU_T3 perfectly on NEU_T2
NEUlv_T4 ~ 1*NEUlv_T3     # This parameter regresses NEU_T4 perfectly on NEU_T3

dCOG1 =~ 1*COGlv_T2       # This defines the change score as measured perfectly by scores on COG_T2
dCOG2 =~ 1*COGlv_T3       # This defines the change score as measured perfectly by scores on COG_T3
dCOG3 =~ 1*COGlv_T4       # This defines the change score as measured perfectly by scores on COG_T4

dNEU1 =~ 1*NEUlv_T2       # This defines the change score as measured perfectly by scores on NEU_T2
dNEU2 =~ 1*NEUlv_T3       # This defines the change score as measured perfectly by scores on NEU_T3
dNEU3 =~ 1*NEUlv_T4       # This defines the change score as measured perfectly by scores on NEU_T4

COG_T1~~COG_T1          # This estimates the COG residual variances 
COG_T2~~COG_T2          # This estimates the COG residual variances 
COG_T3~~COG_T3          # This estimates the COG residual variances 
COG_T4~~COG_T4          # This estimates the COG residual variances 

NEU_T1~~NEU_T1          # This estimates the NEU residual variances 
NEU_T2~~NEU_T2          # This estimates the NEU residual variances 
NEU_T3~~NEU_T3          # This estimates the NEU residual variances 
NEU_T4~~NEU_T4          # This estimates the NEU residual variances 

#Dynamics

dNEU1~B1*NEUlv_T1       # This estimates the NEU self-feedback parameter 
dNEU2~B1*NEUlv_T2       # This estimates the NEU self-feedback parameter 
dNEU3~B1*NEUlv_T3       # This estimates the NEU self-feedback parameter 

dCOG1~B2*COGlv_T1       # This estimates the COG self-feedback parameter 
dCOG2~B2*COGlv_T2       # This estimates the COG self-feedback parameter 
dCOG3~B2*COGlv_T3       # This estimates the COG self-feedback parameter 

dNEU1~C1*COGlv_T1         # This estimates the COG to NEU coupling parameter 
dNEU2~C1*COGlv_T2         # This estimates the COG to NEU coupling parameter 
dNEU3~C1*COGlv_T3         # This estimates the COG to NEU coupling parameter 

dCOG1~C2*NEUlv_T1        # This estimates the NEU to COG coupling parameter 
dCOG2~C2*NEUlv_T2        # This estimates the NEU to COG coupling parameter 
dCOG3~C2*NEUlv_T3        # This estimates the NEU to COG coupling parameter 


iCOG=~1*COGlv_T1                   # This defines the COG intercept measurement model
sCOG=~1*dCOG1+1*dCOG2+1*dCOG3      # This defines the COG slope measurement model
iCOG~1                             # This estimates the COG intercept intercept (mean)
iCOG~~iCOG                         # This estimates the COG intercept variance
sCOG~1                             # This estimates the COG slope intercept
sCOG~~sCOG                         # This estimates the COG slope variance

iNEU=~1*NEUlv_T1                   # This defines the NEU slope measurement model
sNEU=~1*dNEU1+1*dNEU2+1*dNEU3      # This defines the NEU slope measurement model
iNEU~1                             # This estimates the NEU intercept intercept (mean)
iNEU~~iNEU                         # This estimates the NEU intercept variance
sNEU~1                             # This estimates the NEU slope intercept
sNEU~~sNEU                         # This estimates the NEU slope variance

iNEU~~sNEU                      # This estimates the iNEU sNEU covariance
iNEU~~sCOG                      # This estimates the iNEU sCOG covariance
iNEU~~iCOG                      # This estimates the iNEU iCOG covariance
iCOG~~sCOG                      # This estimates the iCOG sCOG covariance        
iCOG~~sNEU                      # This estimates the iCOG sNEU covariance
sCOG~~sNEU                      # This estimates the sCOG sNEU covariance  

&#39;

fitBDCS &lt;- lavaan(BDCS, data=simdatBD, missing=&quot;ML&quot;)
summary(fitBDCS, fit.measures=TRUE, standardized=TRUE) </code></pre>
<pre><code>## lavaan 0.6-4 ended normally after 149 iterations
## 
##   Optimization method                           NLMINB
##   Number of free parameters                         34
##   Number of equality constraints                     8
##   Row rank of the constraints matrix                 8
## 
##   Number of observations                           500
##   Number of missing patterns                         1
## 
##   Estimator                                         ML
##   Model Fit Test Statistic                      13.389
##   Degrees of freedom                                18
##   P-value (Chi-square)                           0.768
## 
## Model test baseline model:
## 
##   Minimum Function Test Statistic             3140.634
##   Degrees of freedom                                28
##   P-value                                        0.000
## 
## User model versus baseline model:
## 
##   Comparative Fit Index (CFI)                    1.000
##   Tucker-Lewis Index (TLI)                       1.002
## 
## Loglikelihood and Information Criteria:
## 
##   Loglikelihood user model (H0)             -10661.038
##   Loglikelihood unrestricted model (H1)     -10654.344
## 
##   Number of free parameters                         26
##   Akaike (AIC)                               21374.077
##   Bayesian (BIC)                             21483.657
##   Sample-size adjusted Bayesian (BIC)        21401.131
## 
## Root Mean Square Error of Approximation:
## 
##   RMSEA                                          0.000
##   90 Percent Confidence Interval          0.000  0.028
##   P-value RMSEA &lt;= 0.05                          0.999
## 
## Standardized Root Mean Square Residual:
## 
##   SRMR                                           0.021
## 
## Parameter Estimates:
## 
##   Information                                 Observed
##   Observed information based on                Hessian
##   Standard Errors                             Standard
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   COGlv_T1 =~                                                           
##     COG_T1            1.000                               1.606    0.575
##   COGlv_T2 =~                                                           
##     COG_T2            1.000                               3.447    0.842
##   COGlv_T3 =~                                                           
##     COG_T3            1.000                               6.131    0.929
##   COGlv_T4 =~                                                           
##     COG_T4            1.000                               9.893    0.965
##   NEUlv_T1 =~                                                           
##     NEU_T1            1.000                               1.742    0.605
##   NEUlv_T2 =~                                                           
##     NEU_T2            1.000                               3.175    0.792
##   NEUlv_T3 =~                                                           
##     NEU_T3            1.000                               5.492    0.926
##   NEUlv_T4 =~                                                           
##     NEU_T4            1.000                               8.717    0.954
##   dCOG1 =~                                                              
##     COGlv_T2          1.000                               0.732    0.732
##   dCOG2 =~                                                              
##     COGlv_T3          1.000                               0.467    0.467
##   dCOG3 =~                                                              
##     COGlv_T4          1.000                               0.399    0.399
##   dNEU1 =~                                                              
##     NEUlv_T2          1.000                               0.673    0.673
##   dNEU2 =~                                                              
##     NEUlv_T3          1.000                               0.448    0.448
##   dNEU3 =~                                                              
##     NEUlv_T4          1.000                               0.381    0.381
##   iCOG =~                                                               
##     COGlv_T1          1.000                               1.000    1.000
##   sCOG =~                                                               
##     dCOG1             1.000                               0.851    0.851
##     dCOG2             1.000                               0.750    0.750
##     dCOG3             1.000                               0.544    0.544
##   iNEU =~                                                               
##     NEUlv_T1          1.000                               1.000    1.000
##   sNEU =~                                                               
##     dNEU1             1.000                               0.910    0.910
##     dNEU2             1.000                               0.791    0.791
##     dNEU3             1.000                               0.586    0.586
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   COGlv_T2 ~                                                            
##     COGlv_T1          1.000                               0.466    0.466
##   COGlv_T3 ~                                                            
##     COGlv_T2          1.000                               0.562    0.562
##   COGlv_T4 ~                                                            
##     COGlv_T3          1.000                               0.620    0.620
##   NEUlv_T2 ~                                                            
##     NEUlv_T1          1.000                               0.549    0.549
##   NEUlv_T3 ~                                                            
##     NEUlv_T2          1.000                               0.578    0.578
##   NEUlv_T4 ~                                                            
##     NEUlv_T3          1.000                               0.630    0.630
##   dNEU1 ~                                                               
##     NEUlv_T1  (B1)   -0.030    0.078   -0.388    0.698   -0.025   -0.025
##   dNEU2 ~                                                               
##     NEUlv_T2  (B1)   -0.030    0.078   -0.388    0.698   -0.039   -0.039
##   dNEU3 ~                                                               
##     NEUlv_T3  (B1)   -0.030    0.078   -0.388    0.698   -0.050   -0.050
##   dCOG1 ~                                                               
##     COGlv_T1  (B2)   -0.122    0.068   -1.778    0.075   -0.077   -0.077
##   dCOG2 ~                                                               
##     COGlv_T2  (B2)   -0.122    0.068   -1.778    0.075   -0.146   -0.146
##   dCOG3 ~                                                               
##     COGlv_T3  (B2)   -0.122    0.068   -1.778    0.075   -0.189   -0.189
##   dNEU1 ~                                                               
##     COGlv_T1  (C1)    0.357    0.069    5.151    0.000    0.268    0.268
##   dNEU2 ~                                                               
##     COGlv_T2  (C1)    0.357    0.069    5.151    0.000    0.500    0.500
##   dNEU3 ~                                                               
##     COGlv_T3  (C1)    0.357    0.069    5.151    0.000    0.659    0.659
##   dCOG1 ~                                                               
##     NEUlv_T1  (C2)    0.627    0.076    8.296    0.000    0.433    0.433
##   dCOG2 ~                                                               
##     NEUlv_T2  (C2)    0.627    0.076    8.296    0.000    0.696    0.696
##   dCOG3 ~                                                               
##     NEUlv_T3  (C2)    0.627    0.076    8.296    0.000    0.873    0.873
## 
## Covariances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   iNEU ~~                                                               
##     sNEU              0.948    0.318    2.983    0.003    0.280    0.280
##   sCOG ~~                                                               
##     iNEU              0.766    0.360    2.129    0.033    0.205    0.205
##   iCOG ~~                                                               
##     iNEU              1.068    0.325    3.283    0.001    0.382    0.382
##     sCOG              1.113    0.340    3.272    0.001    0.323    0.323
##     sNEU              0.754    0.300    2.511    0.012    0.241    0.241
##   sCOG ~~                                                               
##     sNEU              0.399    0.393    1.015    0.310    0.096    0.096
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##     iCOG              2.187    0.121   18.079    0.000    1.362    1.362
##     sCOG              1.818    0.182    9.999    0.000    0.847    0.847
##     iNEU              1.929    0.124   15.575    0.000    1.107    1.107
##     sNEU              2.012    0.172   11.718    0.000    1.035    1.035
##    .COG_T1            0.000                               0.000    0.000
##    .COG_T2            0.000                               0.000    0.000
##    .COG_T3            0.000                               0.000    0.000
##    .COG_T4            0.000                               0.000    0.000
##    .NEU_T1            0.000                               0.000    0.000
##    .NEU_T2            0.000                               0.000    0.000
##    .NEU_T3            0.000                               0.000    0.000
##    .NEU_T4            0.000                               0.000    0.000
##    .COGlv_T1          0.000                               0.000    0.000
##    .COGlv_T2          0.000                               0.000    0.000
##    .COGlv_T3          0.000                               0.000    0.000
##    .COGlv_T4          0.000                               0.000    0.000
##    .NEUlv_T1          0.000                               0.000    0.000
##    .NEUlv_T2          0.000                               0.000    0.000
##    .NEUlv_T3          0.000                               0.000    0.000
##    .NEUlv_T4          0.000                               0.000    0.000
##    .dCOG1             0.000                               0.000    0.000
##    .dCOG2             0.000                               0.000    0.000
##    .dCOG3             0.000                               0.000    0.000
##    .dNEU1             0.000                               0.000    0.000
##    .dNEU2             0.000                               0.000    0.000
##    .dNEU3             0.000                               0.000    0.000
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .COG_T1            5.229    0.628    8.321    0.000    5.229    0.670
##    .COG_T2            4.875    0.404   12.070    0.000    4.875    0.291
##    .COG_T3            5.994    0.587   10.210    0.000    5.994    0.138
##    .COG_T4            7.294    1.053    6.925    0.000    7.294    0.069
##    .NEU_T1            5.261    0.605    8.691    0.000    5.261    0.634
##    .NEU_T2            5.989    0.456   13.120    0.000    5.989    0.373
##    .NEU_T3            4.986    0.518    9.622    0.000    4.986    0.142
##    .NEU_T4            7.503    1.033    7.260    0.000    7.503    0.090
##     iCOG              2.579    0.584    4.414    0.000    1.000    1.000
##     sCOG              4.605    0.663    6.949    0.000    1.000    1.000
##     iNEU              3.036    0.563    5.389    0.000    1.000    1.000
##     sNEU              3.783    0.587    6.446    0.000    1.000    1.000
##    .COGlv_T1          0.000                               0.000    0.000
##    .COGlv_T2          0.000                               0.000    0.000
##    .COGlv_T3          0.000                               0.000    0.000
##    .COGlv_T4          0.000                               0.000    0.000
##    .NEUlv_T1          0.000                               0.000    0.000
##    .NEUlv_T2          0.000                               0.000    0.000
##    .NEUlv_T3          0.000                               0.000    0.000
##    .NEUlv_T4          0.000                               0.000    0.000
##    .dCOG1             0.000                               0.000    0.000
##    .dCOG2             0.000                               0.000    0.000
##    .dCOG3             0.000                               0.000    0.000
##    .dNEU1             0.000                               0.000    0.000
##    .dNEU2             0.000                               0.000    0.000
##    .dNEU3             0.000                               0.000    0.000</code></pre>
<div id="alt-and-alt-sr" class="section level2">
<h2>ALT and ALT-SR</h2>
<p>Another way to build both a growth model and look at more specific time associations are through auto-regressive latent trajectory models (ALT) and ALT models with structured residuals (ALT-SR). The latter is a newer (and better) implimentation of the ALT idea.</p>
</div>
</div>

    </div>

    


    



    
      








  
  
  







      
      
    

    
    <div class="article-widget">
      
<div class="post-nav">
  
  
  
  <div class="post-nav-item">
    <div class="meta-nav">Next</div>
    <a href="/lectures/mixture-models/" rel="next">Mixture models</a>
  </div>
  
  
  
  <div class="post-nav-item">
    <div class="meta-nav">Previous</div>
    <a href="/lectures/week-9/" rel="prev">Week 9 &amp; 10</a>
  </div>
  
</div>

    </div>
    

    


  </div>
</article>

      

    
    
    
    <script src="/js/mathjax-config.js"></script>
    

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" integrity="sha256-X5PoE3KU5l+JcX+w09p/wHl9AzK333C4hJ2I9S5mD4M=" crossorigin="anonymous"></script>

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mermaid/8.0.0/mermaid.min.js" integrity="sha256-0w92bcB21IY5+rGI84MGj52jNfHNbXVeQLrZ0CGdjNY=" crossorigin="anonymous" title="mermaid"></script>
      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js" integrity="sha256-aYTdUrn6Ow1DDgh5JTc3aDGnnju48y/1c8s1dgkYPQ8=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/r.min.js"></script>
        
      

      
      
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS_CHTML-full" integrity="sha256-GhM+5JHb6QUzOQPXSJLEWP7R73CbkisjzK5Eyij4U9w=" crossorigin="anonymous" async></script>
      
    

    
    

    
    
    <script>hljs.initHighlightingOnLoad();</script>
    

    
    
    <script>
      const search_index_filename = "/index.json";
      const i18n = {
        'placeholder': "Search...",
        'results': "results found",
        'no_results': "No results found"
      };
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/academic.min.16bbb3750feb7244c9bc409a5a4fe678.js"></script>

    






  
  <div class="container">
    <footer class="site-footer">
  
  <p class="powered-by">
    
      <a href="/privacy/">Privacy Policy</a>
    
    
       &middot; 
      <a href="/terms/">Terms</a>
        
  </p>
  

  <p class="powered-by">
    

    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
    <span class="float-right" aria-hidden="true">
      <a href="#" id="back_to_top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
